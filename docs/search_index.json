[["cox-regression.html", "Chapter 4 Cox Regression 4.1 Diagnostics", " Chapter 4 Cox Regression The following code fits the Proportional Cox Hazard model. # Proportional Hazards Model # recid.ph &lt;- coxph(Surv(week, arrest) ~ fin + age + wexp + mar +paro + prio, data = recid) summary(recid.ph) ## Call: ## coxph(formula = Surv(week, arrest) ~ fin + age + wexp + mar + ## paro + prio, data = recid) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.36554 0.69382 0.19090 -1.915 0.05552 . ## age -0.05633 0.94523 0.02189 -2.573 0.01007 * ## wexp -0.15699 0.85471 0.21208 -0.740 0.45916 ## mar -0.47130 0.62419 0.38027 -1.239 0.21520 ## paro -0.07792 0.92504 0.19530 -0.399 0.68991 ## prio 0.08966 1.09380 0.02871 3.123 0.00179 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.6938 1.4413 0.4773 1.0087 ## age 0.9452 1.0579 0.9055 0.9867 ## wexp 0.8547 1.1700 0.5640 1.2952 ## mar 0.6242 1.6021 0.2962 1.3152 ## paro 0.9250 1.0810 0.6308 1.3564 ## prio 1.0938 0.9142 1.0340 1.1571 ## ## Concordance= 0.639 (se = 0.027 ) ## Likelihood ratio test= 32.14 on 6 df, p=2e-05 ## Wald test = 30.79 on 6 df, p=3e-05 ## Score (logrank) test = 32.28 on 6 df, p=1e-05 # Parameter Interpretation # recid.ph2 &lt;- coxph(Surv(week, arrest) ~ fin + age + prio, data = recid) summary(recid.ph2) ## Call: ## coxph(formula = Surv(week, arrest) ~ fin + age + prio, data = recid) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.34695 0.70684 0.19025 -1.824 0.068197 . ## age -0.06711 0.93510 0.02085 -3.218 0.001289 ** ## prio 0.09689 1.10174 0.02725 3.555 0.000378 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.7068 1.4148 0.4868 1.0263 ## age 0.9351 1.0694 0.8977 0.9741 ## prio 1.1017 0.9077 1.0444 1.1622 ## ## Concordance= 0.63 (se = 0.027 ) ## Likelihood ratio test= 29.05 on 3 df, p=2e-06 ## Wald test = 27.94 on 3 df, p=4e-06 ## Score (logrank) test = 29.03 on 3 df, p=2e-06 (exp(coef(recid.ph2))-1)*100 ## fin age prio ## -29.31625 -6.49033 10.17427 # Automatic Selection Techniques # full.model &lt;- coxph(Surv(week, arrest) ~ fin + age + wexp + mar +paro + prio, data = recid) empty.model &lt;- coxph(Surv(week, arrest ) ~ 1, data = recid) step.model &lt;- step(empty.model, scope = list(lower=formula(empty.model), upper=formula(full.model)), direction = &quot;both&quot;) ## Start: AIC=1350.76 ## Surv(week, arrest) ~ 1 ## ## Df AIC ## + age 1 1337.5 ## + prio 1 1340.8 ## + wexp 1 1343.1 ## + mar 1 1348.1 ## + fin 1 1348.9 ## &lt;none&gt; 1350.8 ## + paro 1 1352.4 ## ## Step: AIC=1337.49 ## Surv(week, arrest) ~ age ## ## Df AIC ## + prio 1 1329.1 ## + wexp 1 1336.4 ## + fin 1 1336.5 ## &lt;none&gt; 1337.5 ## + mar 1 1337.5 ## + paro 1 1338.6 ## - age 1 1350.8 ## ## Step: AIC=1329.08 ## Surv(week, arrest) ~ age + prio ## ## Df AIC ## + fin 1 1327.7 ## + mar 1 1329.0 ## &lt;none&gt; 1329.1 ## + wexp 1 1330.0 ## + paro 1 1330.9 ## - prio 1 1337.5 ## - age 1 1340.8 ## ## Step: AIC=1327.71 ## Surv(week, arrest) ~ age + prio + fin ## ## Df AIC ## + mar 1 1327.3 ## &lt;none&gt; 1327.7 ## + wexp 1 1328.6 ## - fin 1 1329.1 ## + paro 1 1329.4 ## - prio 1 1336.5 ## - age 1 1338.3 ## ## Step: AIC=1327.35 ## Surv(week, arrest) ~ age + prio + fin + mar ## ## Df AIC ## &lt;none&gt; 1327.3 ## - mar 1 1327.7 ## + wexp 1 1328.8 ## - fin 1 1329.0 ## + paro 1 1329.2 ## - age 1 1335.4 ## - prio 1 1336.2 summary(step.model) ## Call: ## coxph(formula = Surv(week, arrest) ~ age + prio + fin + mar, ## data = recid) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## age -0.06042 0.94137 0.02085 -2.897 0.00376 ** ## prio 0.09751 1.10243 0.02722 3.583 0.00034 *** ## fin -0.36020 0.69753 0.19049 -1.891 0.05864 . ## mar -0.53312 0.58677 0.37276 -1.430 0.15266 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## age 0.9414 1.0623 0.9037 0.9806 ## prio 1.1024 0.9071 1.0452 1.1628 ## fin 0.6975 1.4336 0.4802 1.0132 ## mar 0.5868 1.7042 0.2826 1.2183 ## ## Concordance= 0.633 (se = 0.027 ) ## Likelihood ratio test= 31.41 on 4 df, p=3e-06 ## Wald test = 29.98 on 4 df, p=5e-06 ## Score (logrank) test = 31.25 on 4 df, p=3e-06 full.model &lt;- coxph(Surv(week, arrest) ~ fin + age + wexp + mar +paro + prio, data = recid) back.model &lt;- step(full.model, direction = &quot;backward&quot;) ## Start: AIC=1330.62 ## Surv(week, arrest) ~ fin + age + wexp + mar + paro + prio ## ## Df AIC ## - paro 1 1328.8 ## - wexp 1 1329.2 ## - mar 1 1330.3 ## &lt;none&gt; 1330.6 ## - fin 1 1332.3 ## - age 1 1336.3 ## - prio 1 1337.2 ## ## Step: AIC=1328.78 ## Surv(week, arrest) ~ fin + age + wexp + mar + prio ## ## Df AIC ## - wexp 1 1327.3 ## - mar 1 1328.6 ## &lt;none&gt; 1328.8 ## - fin 1 1330.4 ## - age 1 1334.3 ## - prio 1 1335.8 ## ## Step: AIC=1327.35 ## Surv(week, arrest) ~ fin + age + mar + prio ## ## Df AIC ## &lt;none&gt; 1327.3 ## - mar 1 1327.7 ## - fin 1 1329.0 ## - age 1 1335.4 ## - prio 1 1336.2 summary(back.model) ## Call: ## coxph(formula = Surv(week, arrest) ~ fin + age + mar + prio, ## data = recid) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.36020 0.69753 0.19049 -1.891 0.05864 . ## age -0.06042 0.94137 0.02085 -2.897 0.00376 ** ## mar -0.53312 0.58677 0.37276 -1.430 0.15266 ## prio 0.09751 1.10243 0.02722 3.583 0.00034 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.6975 1.4336 0.4802 1.0132 ## age 0.9414 1.0623 0.9037 0.9806 ## mar 0.5868 1.7042 0.2826 1.2183 ## prio 1.1024 0.9071 1.0452 1.1628 ## ## Concordance= 0.633 (se = 0.027 ) ## Likelihood ratio test= 31.41 on 4 df, p=3e-06 ## Wald test = 29.98 on 4 df, p=5e-06 ## Score (logrank) test = 31.25 on 4 df, p=3e-06 full.model &lt;- coxph(Surv(week, arrest) ~ fin + age + wexp + mar +paro + prio, data = recid) empty.model &lt;- coxph(Surv(week, arrest) ~ 1, data = recid) for.model &lt;- step(empty.model, scope = list(lower=formula(empty.model), upper=formula(full.model)), direction = &quot;forward&quot;) ## Start: AIC=1350.76 ## Surv(week, arrest) ~ 1 ## ## Df AIC ## + age 1 1337.5 ## + prio 1 1340.8 ## + wexp 1 1343.1 ## + mar 1 1348.1 ## + fin 1 1348.9 ## &lt;none&gt; 1350.8 ## + paro 1 1352.4 ## ## Step: AIC=1337.49 ## Surv(week, arrest) ~ age ## ## Df AIC ## + prio 1 1329.1 ## + wexp 1 1336.4 ## + fin 1 1336.5 ## &lt;none&gt; 1337.5 ## + mar 1 1337.5 ## + paro 1 1338.6 ## ## Step: AIC=1329.08 ## Surv(week, arrest) ~ age + prio ## ## Df AIC ## + fin 1 1327.7 ## + mar 1 1329.0 ## &lt;none&gt; 1329.1 ## + wexp 1 1330.0 ## + paro 1 1330.9 ## ## Step: AIC=1327.71 ## Surv(week, arrest) ~ age + prio + fin ## ## Df AIC ## + mar 1 1327.3 ## &lt;none&gt; 1327.7 ## + wexp 1 1328.6 ## + paro 1 1329.4 ## ## Step: AIC=1327.35 ## Surv(week, arrest) ~ age + prio + fin + mar ## ## Df AIC ## &lt;none&gt; 1327.3 ## + wexp 1 1328.8 ## + paro 1 1329.2 summary(for.model) ## Call: ## coxph(formula = Surv(week, arrest) ~ age + prio + fin + mar, ## data = recid) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## age -0.06042 0.94137 0.02085 -2.897 0.00376 ** ## prio 0.09751 1.10243 0.02722 3.583 0.00034 *** ## fin -0.36020 0.69753 0.19049 -1.891 0.05864 . ## mar -0.53312 0.58677 0.37276 -1.430 0.15266 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## age 0.9414 1.0623 0.9037 0.9806 ## prio 1.1024 0.9071 1.0452 1.1628 ## fin 0.6975 1.4336 0.4802 1.0132 ## mar 0.5868 1.7042 0.2826 1.2183 ## ## Concordance= 0.633 (se = 0.027 ) ## Likelihood ratio test= 31.41 on 4 df, p=3e-06 ## Wald test = 29.98 on 4 df, p=5e-06 ## Score (logrank) test = 31.25 on 4 df, p=3e-06 # Estimated Survival Curves # newdata &lt;- data.frame(fin = c(1, 0), age = 30, wexp = c(1, 0), mar = 0, paro = 0, prio = c(0, 4)) ggsurvplot(survfit(recid.ph, newdata), data = newdata, break.y.by = 0.1, palette = c(&quot;purple&quot;, &quot;black&quot;), ylab = &quot;survival probability&quot;, xlab = &quot;week&quot;, legend.labs = c(&quot;1&quot;, &quot;2&quot;), legend.title = &quot;subject&quot;) ## Warning: `gather_()` was deprecated in tidyr 1.2.0. ## Please use `gather()` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated. 4.1 Diagnostics Assumptions made for the Cox PH model is linearity for the continuous variables and proportional hazards throughout time (i.e.Â at EACH time point, the proportion between the hazards remains the same!). We can assess both of these through use of residuals. # Concordance recid.ph = coxph(Surv(week, arrest) ~ fin + age + prio, data = recid) concordance(recid.ph) ## Call: ## concordance.coxph(object = recid.ph) ## ## n= 432 ## Concordance= 0.6302 se= 0.02729 ## concordant discordant tied.x tied.y tied.xy ## 26736 15651 195 111 0 ## Partial residuals...Linearity recid.ph &lt;- coxph(Surv(week, arrest) ~ fin + age + wexp + mar +paro + prio, data = recid) visreg(recid.ph, &quot;age&quot;, xlab = &quot;age&quot;, ylab = &quot;partial residuals&quot;, gg = TRUE, band = FALSE) + geom_smooth(col = &quot;red&quot;, fill = &quot;red&quot;) + theme_bw() ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; visreg(recid.ph, &quot;prio&quot;, xlab = &quot;#prior convictions&quot;, ylab = &quot;partial residuals&quot;, gg = TRUE, band = FALSE) + geom_smooth(col = &quot;red&quot;, fill = &quot;red&quot;) + theme_bw() ## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39; ## Martingale residuals...Linearity recid.lin &lt;- coxph(Surv(week, arrest) ~ age + prio, data = recid) survminer::ggcoxfunctional(recid.lin,data=recid) ## Try transformations recid.lin &lt;- coxph(Surv(week, arrest) ~ sqrt(age) , data = recid) survminer::ggcoxfunctional(recid.lin,data=recid) # Proportional Hazard Test - Schoenfeld Residuals recid.ph.zph &lt;- cox.zph(recid.ph, transform = &quot;identity&quot;) recid.ph.zph ## chisq df p ## fin 0.00878 1 0.9254 ## age 6.55134 1 0.0105 ## wexp 3.94780 1 0.0469 ## mar 1.04080 1 0.3076 ## paro 0.02280 1 0.8800 ## prio 0.42929 1 0.5123 ## GLOBAL 16.85230 6 0.0098 ggcoxzph(recid.ph.zph) # Can try transformations.. recid.ph.zph2 = cox.zph(recid.ph, transform = &quot;km&quot;) recid.ph.zph2 ## chisq df p ## fin 0.0621 1 0.803 ## age 5.9161 1 0.015 ## wexp 4.2983 1 0.038 ## mar 1.0207 1 0.312 ## paro 0.0140 1 0.906 ## prio 0.5254 1 0.469 ## GLOBAL 16.4474 6 0.012 recid.ph.zph3 = cox.zph(recid.ph, transform = &quot;identity&quot;) recid.ph.zph3 ## chisq df p ## fin 0.00878 1 0.9254 ## age 6.55134 1 0.0105 ## wexp 3.94780 1 0.0469 ## mar 1.04080 1 0.3076 ## paro 0.02280 1 0.8800 ## prio 0.42929 1 0.5123 ## GLOBAL 16.85230 6 0.0098 recid.ph.zph4 = cox.zph(recid.ph, transform = &quot;log&quot;) recid.ph.zph4 ## chisq df p ## fin 0.1391 1 0.7092 ## age 8.1533 1 0.0043 ## wexp 2.1341 1 0.1441 ## mar 1.1319 1 0.2874 ## paro 0.2092 1 0.6474 ## prio 0.0126 1 0.9105 ## GLOBAL 16.6501 6 0.0107 If we believe that the PH assumption is not true for one (or more) variables, then we can explore what type of relationship is the best (with respect to time). Options are identity, log and KM (although identity and log are the most commonly used). The first part of the code below illustrates how to fit the time-dependent coefficients. The second part of the R code below illustrates how to fit time-varying variables (variables that change their values throughout time). # Time-Dependent Coefficients # recid.ph.tdc &lt;- coxph(Surv(week, arrest) ~ fin + wexp + mar + paro + prio+ age + tt(age), data = recid, tt = function(x, time, ...){x*log(time)}) summary(recid.ph.tdc) ## Call: ## coxph(formula = Surv(week, arrest) ~ fin + wexp + mar + paro + ## prio + age + tt(age), data = recid, tt = function(x, time, ## ...) { ## x * log(time) ## }) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.36527 0.69401 0.19087 -1.914 0.05566 . ## wexp -0.13317 0.87531 0.21247 -0.627 0.53080 ## mar -0.45279 0.63585 0.38041 -1.190 0.23394 ## paro -0.08490 0.91860 0.19534 -0.435 0.66382 ## prio 0.09177 1.09611 0.02880 3.186 0.00144 ** ## age 0.12174 1.12946 0.06535 1.863 0.06249 . ## tt(age) -0.05931 0.94242 0.02182 -2.718 0.00658 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.6940 1.4409 0.4774 1.0089 ## wexp 0.8753 1.1424 0.5772 1.3275 ## mar 0.6358 1.5727 0.3017 1.3402 ## paro 0.9186 1.0886 0.6264 1.3471 ## prio 1.0961 0.9123 1.0359 1.1598 ## age 1.1295 0.8854 0.9937 1.2838 ## tt(age) 0.9424 1.0611 0.9030 0.9836 ## ## Concordance= 0.648 (se = 0.027 ) ## Likelihood ratio test= 38.72 on 7 df, p=2e-06 ## Wald test = 35.09 on 7 df, p=1e-05 ## Score (logrank) test = 36.97 on 7 df, p=5e-06 recid.ph.tdc &lt;- coxph(Surv(week, arrest) ~ fin + prio + age + tt(age), data = recid, tt = function(x, time, ...){x*log(time)}) summary(recid.ph.tdc) ## Call: ## coxph(formula = Surv(week, arrest) ~ fin + prio + age + tt(age), ## data = recid, tt = function(x, time, ...) { ## x * log(time) ## }) ## ## n= 432, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.34878 0.70555 0.19025 -1.833 0.066762 . ## prio 0.09837 1.10337 0.02731 3.603 0.000315 *** ## age 0.11991 1.12739 0.06623 1.810 0.070220 . ## tt(age) -0.06195 0.93993 0.02207 -2.807 0.005005 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.7055 1.4173 0.4859 1.0244 ## prio 1.1034 0.9063 1.0459 1.1640 ## age 1.1274 0.8870 0.9901 1.2837 ## tt(age) 0.9399 1.0639 0.9001 0.9815 ## ## Concordance= 0.635 (se = 0.028 ) ## Likelihood ratio test= 36 on 4 df, p=3e-07 ## Wald test = 32.41 on 4 df, p=2e-06 ## Score (logrank) test = 33.75 on 4 df, p=8e-07 # Time Varying Variables # recid_long.ph &lt;- coxph(Surv(start, stop, arrested) ~ fin + age + prio + employed, data = recid_long) summary(recid_long.ph) ## Call: ## coxph(formula = Surv(start, stop, arrested) ~ fin + age + prio + ## employed, data = recid_long) ## ## n= 19809, number of events= 114 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.33051 0.71856 0.19012 -1.738 0.08214 . ## age -0.04977 0.95145 0.02053 -2.424 0.01537 * ## prio 0.08364 1.08724 0.02775 3.014 0.00258 ** ## employed -1.34815 0.25972 0.24928 -5.408 6.37e-08 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.7186 1.3917 0.4950 1.0430 ## age 0.9515 1.0510 0.9139 0.9905 ## prio 1.0872 0.9198 1.0297 1.1480 ## employed 0.2597 3.8503 0.1593 0.4233 ## ## Concordance= 0.703 (se = 0.023 ) ## Likelihood ratio test= 66.19 on 4 df, p=1e-13 ## Wald test = 53.93 on 4 df, p=5e-11 ## Score (logrank) test = 62.05 on 4 df, p=1e-12 recid_lag.ph &lt;- coxph(Surv(start, stop, arrested) ~ fin + age + prio + employed, data = recid_lag) summary(recid_lag.ph) ## Call: ## coxph(formula = Surv(start, stop, arrested) ~ fin + age + prio + ## employed, data = recid_lag) ## ## n= 19377, number of events= 113 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## fin -0.32464 0.72278 0.19077 -1.702 0.088803 . ## age -0.05462 0.94685 0.02073 -2.635 0.008409 ** ## prio 0.09158 1.09590 0.02753 3.326 0.000880 *** ## employed -0.81123 0.44431 0.21648 -3.747 0.000179 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## fin 0.7228 1.3835 0.4973 1.0505 ## age 0.9468 1.0561 0.9092 0.9861 ## prio 1.0959 0.9125 1.0383 1.1567 ## employed 0.4443 2.2507 0.2907 0.6791 ## ## Concordance= 0.665 (se = 0.027 ) ## Likelihood ratio test= 44.5 on 4 df, p=5e-09 ## Wald test = 40.91 on 4 df, p=3e-08 ## Score (logrank) test = 43.68 on 4 df, p=7e-09 "],["competing-risks.html", "Chapter 5 Competing Risks", " Chapter 5 Competing Risks The following code illustrates how to do a competing risk model. leaders$lost = factor(leaders$lost, 0:3, labels = c(&quot;In-Office&quot;, &quot;Constitutional&quot;, &quot;Natural&quot;, &quot;Non-Constitutional&quot;)) # Cumulative Incidence Functions # cif.dat=leaders[leaders$lost!=&quot;In-Office&quot;,] cif.tenure=cif.dat$years cif.status=cif.dat$lost cif.leaders=cuminc(cif.tenure,cif.status,rho=0) ggcompetingrisks(cif.leaders) # Cox Regression Competing Risks # tenure=leaders$years View(leaders) status.leaders=leaders$lost x=leaders[,3:12] x$africa=ifelse(leaders$region==1,1,0) x$asia=ifelse(leaders$region==2,1,0) x$latin=ifelse(leaders$region==3,1,0) gray.natural=crr(tenure,status.leaders,x,failcode=&quot;Natural&quot;) ## 34 cases omitted due to missing values summary(gray.natural) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Natural&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner -7.32e-02 0.929 0.562617 -0.13007 0.9000 ## start -8.33e-02 0.920 0.026453 -3.14757 0.0016 ## military -2.51e-01 0.778 0.549101 -0.45674 0.6500 ## age 4.75e-02 1.049 0.018127 2.62190 0.0087 ## conflict -2.13e-03 0.998 0.440003 -0.00484 1.0000 ## loginc 5.55e-01 1.741 0.261591 2.11995 0.0340 ## growth 9.80e-02 1.103 0.128218 0.76408 0.4400 ## pop 2.41e-03 1.002 0.002784 0.86500 0.3900 ## land -8.76e-05 1.000 0.000189 -0.46445 0.6400 ## literacy -6.71e-03 0.993 0.011000 -0.60956 0.5400 ## africa 4.44e-01 1.559 0.710063 0.62578 0.5300 ## asia -6.97e-01 0.498 0.821035 -0.84936 0.4000 ## latin 1.22e-01 1.129 0.625890 0.19434 0.8500 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 0.929 1.076 0.3085 2.800 ## start 0.920 1.087 0.8736 0.969 ## military 0.778 1.285 0.2653 2.283 ## age 1.049 0.954 1.0121 1.087 ## conflict 0.998 1.002 0.4213 2.364 ## loginc 1.741 0.574 1.0427 2.907 ## growth 1.103 0.907 0.8578 1.418 ## pop 1.002 0.998 0.9970 1.008 ## land 1.000 1.000 0.9995 1.000 ## literacy 0.993 1.007 0.9721 1.015 ## africa 1.559 0.641 0.3878 6.272 ## asia 0.498 2.008 0.0996 2.489 ## latin 1.129 0.885 0.3312 3.851 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -149 ## Pseudo likelihood ratio test = 29.4 on 13 df, gray.const=crr(tenure,status.leaders,x,failcode=&quot;Constitutional&quot;) ## 34 cases omitted due to missing values summary(gray.const) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Constitutional&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner -6.20e-01 0.538 2.64e-01 -2.34926 0.0190 ## start -1.79e-02 0.982 9.79e-03 -1.83105 0.0670 ## military 1.22e-01 1.130 2.49e-01 0.48991 0.6200 ## age 1.37e-02 1.014 8.45e-03 1.61657 0.1100 ## conflict -1.67e-01 0.846 2.16e-01 -0.77554 0.4400 ## loginc -1.35e-01 0.874 1.15e-01 -1.17732 0.2400 ## growth 4.18e-02 1.043 3.02e-02 1.38457 0.1700 ## pop 6.68e-04 1.001 8.78e-04 0.76086 0.4500 ## land -2.74e-05 1.000 6.89e-05 -0.39672 0.6900 ## literacy 1.88e-02 1.019 5.77e-03 3.25010 0.0012 ## africa -9.43e-01 0.389 3.94e-01 -2.39044 0.0170 ## asia -3.18e-03 0.997 3.69e-01 -0.00862 0.9900 ## latin 8.25e-02 1.086 3.54e-01 0.23284 0.8200 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 0.538 1.859 0.321 0.902 ## start 0.982 1.018 0.964 1.001 ## military 1.130 0.885 0.693 1.841 ## age 1.014 0.986 0.997 1.031 ## conflict 0.846 1.182 0.554 1.291 ## loginc 0.874 1.145 0.697 1.094 ## growth 1.043 0.959 0.983 1.106 ## pop 1.001 0.999 0.999 1.002 ## land 1.000 1.000 1.000 1.000 ## literacy 1.019 0.981 1.007 1.031 ## africa 0.389 2.568 0.180 0.844 ## asia 0.997 1.003 0.484 2.053 ## latin 1.086 0.921 0.542 2.174 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -814 ## Pseudo likelihood ratio test = 101 on 13 df, gray.nonconst=crr(tenure,status.leaders,x,failcode=&quot;Non-Constitutional&quot;) ## 34 cases omitted due to missing values summary(gray.nonconst) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Non-Constitutional&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner 7.87e-01 2.196 0.196832 3.996 6.4e-05 ## start -5.61e-02 0.945 0.010553 -5.315 1.1e-07 ## military -2.40e-01 0.787 0.200255 -1.199 2.3e-01 ## age -1.34e-03 0.999 0.008335 -0.161 8.7e-01 ## conflict 5.35e-01 1.708 0.183801 2.912 3.6e-03 ## loginc -3.05e-01 0.737 0.128953 -2.363 1.8e-02 ## growth -5.26e-02 0.949 0.029720 -1.769 7.7e-02 ## pop -1.13e-03 0.999 0.000879 -1.284 2.0e-01 ## land -2.69e-05 1.000 0.000079 -0.341 7.3e-01 ## literacy -9.43e-03 0.991 0.004066 -2.320 2.0e-02 ## africa -2.15e-01 0.807 0.284876 -0.753 4.5e-01 ## asia -4.99e-01 0.607 0.364670 -1.369 1.7e-01 ## latin 3.67e-01 1.443 0.290395 1.263 2.1e-01 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 2.196 0.455 1.493 3.230 ## start 0.945 1.058 0.926 0.965 ## military 0.787 1.271 0.531 1.165 ## age 0.999 1.001 0.982 1.015 ## conflict 1.708 0.586 1.191 2.448 ## loginc 0.737 1.356 0.573 0.949 ## growth 0.949 1.054 0.895 1.006 ## pop 0.999 1.001 0.997 1.001 ## land 1.000 1.000 1.000 1.000 ## literacy 0.991 1.009 0.983 0.999 ## africa 0.807 1.239 0.462 1.410 ## asia 0.607 1.648 0.297 1.240 ## latin 1.443 0.693 0.817 2.550 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -855 ## Pseudo likelihood ratio test = 110 on 13 df, "],["repeated-events.html", "Chapter 6 Repeated Events", " Chapter 6 Repeated Events # Independence Model (Andersen-Gill approach) bladder.td &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size , data = bladder) summary(bladder.td) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size, data = bladder) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## rx -0.46469 0.62833 0.19973 -2.327 0.019989 * ## number 0.17496 1.19120 0.04707 3.717 0.000202 *** ## size -0.04366 0.95728 0.06905 -0.632 0.527196 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.6283 1.5915 0.4248 0.9294 ## number 1.1912 0.8395 1.0862 1.3063 ## size 0.9573 1.0446 0.8361 1.0960 ## ## Concordance= 0.634 (se = 0.032 ) ## Likelihood ratio test= 17.52 on 3 df, p=6e-04 ## Wald test = 19.11 on 3 df, p=3e-04 ## Score (logrank) test = 19.52 on 3 df, p=2e-04 # Independence Model - Marginal means bladder.rse &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size + cluster(id), data = bladder) summary(bladder.rse) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size, data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.46469 0.62833 0.19973 0.26556 -1.750 0.08015 . ## number 0.17496 1.19120 0.04707 0.06304 2.775 0.00551 ** ## size -0.04366 0.95728 0.06905 0.07762 -0.563 0.57376 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.6283 1.5915 0.3734 1.057 ## number 1.1912 0.8395 1.0527 1.348 ## size 0.9573 1.0446 0.8222 1.115 ## ## Concordance= 0.634 (se = 0.032 ) ## Likelihood ratio test= 17.52 on 3 df, p=6e-04 ## Wald test = 11.54 on 3 df, p=0.009 ## Score (logrank) test = 19.52 on 3 df, p=2e-04, Robust = 11.27 p=0.01 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Conditional Model - Assuming Variable Effects Same Across Strata - PWP model bladder.con &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size + strata(enum)+cluster(id), data = bladder) summary(bladder.con) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size + strata(enum), data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.333489 0.716420 0.216168 0.204787 -1.628 0.1034 ## number 0.119617 1.127065 0.053338 0.051387 2.328 0.0199 * ## size -0.008495 0.991541 0.072762 0.061635 -0.138 0.8904 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.7164 1.3958 0.4796 1.070 ## number 1.1271 0.8873 1.0191 1.246 ## size 0.9915 1.0085 0.8787 1.119 ## ## Concordance= 0.616 (se = 0.032 ) ## Likelihood ratio test= 6.51 on 3 df, p=0.09 ## Wald test = 7.26 on 3 df, p=0.06 ## Score (logrank) test = 6.91 on 3 df, p=0.07, Robust = 8.83 p=0.03 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Conditional Model - Assuming Variable Effects change Across Strata - PWP model bladder.con &lt;- coxph(Surv(start, stop, event == 1) ~ strata(enum)*rx + strata(enum)*number + strata(enum)*size + cluster(id), data = bladder) summary(bladder.con) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ strata(enum) + ## rx + number + size + strata(enum):rx + strata(enum):number + ## strata(enum):size, data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.52598 0.59097 0.31583 0.31524 -1.669 0.09521 ## number 0.23818 1.26894 0.07588 0.07459 3.193 0.00141 ## size 0.06961 1.07209 0.10156 0.08863 0.785 0.43220 ## strata(enum)enum=2:rx 0.02215 1.02239 0.51451 0.60852 0.036 0.97097 ## strata(enum)enum=3:rx 0.66664 1.94768 0.74348 0.57671 1.156 0.24771 ## strata(enum)enum=4:rx 0.57632 1.77947 0.85238 0.62678 0.919 0.35784 ## strata(enum)enum=2:number -0.26282 0.76888 0.11763 0.16532 -1.590 0.11189 ## strata(enum)enum=3:number -0.18852 0.82819 0.20026 0.14196 -1.328 0.18420 ## strata(enum)enum=4:number -0.03390 0.96667 0.25366 0.19351 -0.175 0.86092 ## strata(enum)enum=2:size -0.23033 0.79427 0.15910 0.17506 -1.316 0.18827 ## strata(enum)enum=3:size 0.09849 1.10350 0.28757 0.18033 0.546 0.58497 ## strata(enum)enum=4:size -0.06052 0.94128 0.35382 0.37643 -0.161 0.87228 ## ## rx . ## number ** ## size ## strata(enum)enum=2:rx ## strata(enum)enum=3:rx ## strata(enum)enum=4:rx ## strata(enum)enum=2:number ## strata(enum)enum=3:number ## strata(enum)enum=4:number ## strata(enum)enum=2:size ## strata(enum)enum=3:size ## strata(enum)enum=4:size ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.5910 1.6921 0.3186 1.096 ## number 1.2689 0.7881 1.0964 1.469 ## size 1.0721 0.9328 0.9011 1.275 ## strata(enum)enum=2:rx 1.0224 0.9781 0.3102 3.370 ## strata(enum)enum=3:rx 1.9477 0.5134 0.6290 6.031 ## strata(enum)enum=4:rx 1.7795 0.5620 0.5209 6.079 ## strata(enum)enum=2:number 0.7689 1.3006 0.5561 1.063 ## strata(enum)enum=3:number 0.8282 1.2075 0.6270 1.094 ## strata(enum)enum=4:number 0.9667 1.0345 0.6616 1.412 ## strata(enum)enum=2:size 0.7943 1.2590 0.5636 1.119 ## strata(enum)enum=3:size 1.1035 0.9062 0.7750 1.571 ## strata(enum)enum=4:size 0.9413 1.0624 0.4501 1.969 ## ## Concordance= 0.629 (se = 0.036 ) ## Likelihood ratio test= 14.5 on 12 df, p=0.3 ## Wald test = 20.29 on 12 df, p=0.06 ## Score (logrank) test = 15.73 on 12 df, p=0.2, Robust = 15.8 p=0.2 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Gap Time Model - Assuming Variable Effects Same Across Strata # # Can easily extend the gap time model to assume variable effects different same as above. # bladder.gap &lt;- coxph(Surv(time = (stop - start), event == 1) ~ rx + number + size + strata(enum) +cluster(id), data = bladder) summary(bladder.gap) ## Call: ## coxph(formula = Surv(time = (stop - start), event == 1) ~ rx + ## number + size + strata(enum), data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.279005 0.756536 0.207348 0.215624 -1.294 0.19569 ## number 0.158046 1.171220 0.051942 0.050940 3.103 0.00192 ** ## size 0.007415 1.007443 0.070023 0.064333 0.115 0.90824 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.7565 1.3218 0.4958 1.154 ## number 1.1712 0.8538 1.0599 1.294 ## size 1.0074 0.9926 0.8881 1.143 ## ## Concordance= 0.596 (se = 0.032 ) ## Likelihood ratio test= 9.33 on 3 df, p=0.03 ## Wald test = 11.84 on 3 df, p=0.008 ## Score (logrank) test = 10.27 on 3 df, p=0.02, Robust = 9.92 p=0.02 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]

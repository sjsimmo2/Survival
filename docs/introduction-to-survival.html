<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Introduction to Survival | Survival Analysis</title>
  <meta name="description" content="Chapter 2 Introduction to Survival | Survival Analysis" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Introduction to Survival | Survival Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Introduction to Survival | Survival Analysis" />
  
  
  

<meta name="author" content="Susan Simmons" />


<meta name="date" content="2023-10-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="accelerated-failure-time-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SurvivalAnalysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Survival Analysis Book</a></li>
<li class="chapter" data-level="2" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html"><i class="fa fa-check"></i><b>2</b> Introduction to Survival</a>
<ul>
<li class="chapter" data-level="2.0.1" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html#python-for-survival-curves"><i class="fa fa-check"></i><b>2.0.1</b> Python for Survival Curves</a></li>
<li class="chapter" data-level="2.1" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html#stratified-analysis"><i class="fa fa-check"></i><b>2.1</b> Stratified Analysis</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html#python-for-stratified-analysis"><i class="fa fa-check"></i><b>2.1.1</b> Python for stratified analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html#hazard-function"><i class="fa fa-check"></i><b>2.2</b> Hazard function</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-survival.html"><a href="introduction-to-survival.html#python-for-hazard-function"><i class="fa fa-check"></i><b>2.2.1</b> Python for Hazard function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html"><i class="fa fa-check"></i><b>3</b> Accelerated Failure Time models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html#predict-mean-survival"><i class="fa fa-check"></i><b>3.1</b> Predict mean survival</a></li>
<li class="chapter" data-level="3.2" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html#predict-quantiles"><i class="fa fa-check"></i><b>3.2</b> Predict quantiles</a></li>
<li class="chapter" data-level="3.3" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html#percentiles-for-an-individual-person"><i class="fa fa-check"></i><b>3.3</b> Percentiles for an individual person</a></li>
<li class="chapter" data-level="3.4" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html#finding-probabilities-of-a-given-value"><i class="fa fa-check"></i><b>3.4</b> Finding probabilities of a given value</a></li>
<li class="chapter" data-level="3.5" data-path="accelerated-failure-time-models.html"><a href="accelerated-failure-time-models.html#interesting-application"><i class="fa fa-check"></i><b>3.5</b> Interesting application</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cox-survival-regression.html"><a href="cox-survival-regression.html"><i class="fa fa-check"></i><b>4</b> Cox Survival Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cox-survival-regression.html"><a href="cox-survival-regression.html#diagnostics"><i class="fa fa-check"></i><b>4.1</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="competing-risks.html"><a href="competing-risks.html"><i class="fa fa-check"></i><b>5</b> Competing Risks</a></li>
<li class="chapter" data-level="6" data-path="extras.html"><a href="extras.html"><i class="fa fa-check"></i><b>6</b> Extras</a>
<ul>
<li class="chapter" data-level="6.1" data-path="extras.html"><a href="extras.html#using-lasso"><i class="fa fa-check"></i><b>6.1</b> Using Lasso</a></li>
<li class="chapter" data-level="6.2" data-path="extras.html"><a href="extras.html#decision-trees"><i class="fa fa-check"></i><b>6.2</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3" data-path="extras.html"><a href="extras.html#random-forest"><i class="fa fa-check"></i><b>6.3</b> Random Forest</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="introduction-to-survival" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Introduction to Survival<a href="introduction-to-survival.html#introduction-to-survival" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Welcome to the Survival Analysis module! This document will be periodically udated throughout the course. As always, first thing we need to do is get all of the packages needed for the course:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="introduction-to-survival.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb1-2"><a href="introduction-to-survival.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(foreign)</span>
<span id="cb1-3"><a href="introduction-to-survival.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="introduction-to-survival.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(survminer)</span>
<span id="cb1-5"><a href="introduction-to-survival.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-6"><a href="introduction-to-survival.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(flexsurv)</span>
<span id="cb1-7"><a href="introduction-to-survival.html#cb1-7" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-8"><a href="introduction-to-survival.html#cb1-8" tabindex="-1"></a><span class="fu">library</span>(ciTools)</span>
<span id="cb1-9"><a href="introduction-to-survival.html#cb1-9" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-10"><a href="introduction-to-survival.html#cb1-10" tabindex="-1"></a><span class="fu">library</span>(visreg)</span>
<span id="cb1-11"><a href="introduction-to-survival.html#cb1-11" tabindex="-1"></a><span class="fu">library</span>(cmprsk)</span>
<span id="cb1-12"><a href="introduction-to-survival.html#cb1-12" tabindex="-1"></a></span>
<span id="cb1-13"><a href="introduction-to-survival.html#cb1-13" tabindex="-1"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb1-14"><a href="introduction-to-survival.html#cb1-14" tabindex="-1"></a></span>
<span id="cb1-15"><a href="introduction-to-survival.html#cb1-15" tabindex="-1"></a><span class="fu">use_python</span>(<span class="st">&quot;C:</span><span class="sc">\\</span><span class="st">ProgramData</span><span class="sc">\\</span><span class="st">Anaconda3</span><span class="sc">\\</span><span class="st">python.exe&quot;</span>)</span></code></pre></div>
<p>Also need to get data sets that will be used throughout this course (all of these can be found on the GitHub repository for the course):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="introduction-to-survival.html#cb2-1" tabindex="-1"></a>loyalty<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/loyalty.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb2-2"><a href="introduction-to-survival.html#cb2-2" tabindex="-1"></a>recid<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/recid.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb2-3"><a href="introduction-to-survival.html#cb2-3" tabindex="-1"></a>recid_long<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/recid_long.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb2-4"><a href="introduction-to-survival.html#cb2-4" tabindex="-1"></a>recid_lag<span class="ot">=</span><span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/recid_lag.csv&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb2-5"><a href="introduction-to-survival.html#cb2-5" tabindex="-1"></a>leaders <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/leaders.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="introduction-to-survival.html#cb2-6" tabindex="-1"></a>bladder <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/bladder.csv&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-7"><a href="introduction-to-survival.html#cb2-7" tabindex="-1"></a>simple<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">ncol=</span><span class="dv">2</span>))</span>
<span id="cb2-8"><a href="introduction-to-survival.html#cb2-8" tabindex="-1"></a><span class="fu">colnames</span>(simple)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;tenure&quot;</span>,<span class="st">&quot;censored&quot;</span>)</span></code></pre></div>
<p>To perform a survival analysis, you need to identify which variable has the “time” information and which variable contains the “censoring” information. This is done through the Surv function. We should always visualize our data and one of the most useful visualizations is the Kaplan-Meier curve (also shown in the code below).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="introduction-to-survival.html#cb3-1" tabindex="-1"></a><span class="co"># Create a Survival Analysis Object </span></span>
<span id="cb3-2"><a href="introduction-to-survival.html#cb3-2" tabindex="-1"></a>simple.s<span class="ot">=</span><span class="fu">Surv</span>(<span class="at">time=</span>simple<span class="sc">$</span>tenure,<span class="at">event=</span>simple<span class="sc">$</span>censored)</span>
<span id="cb3-3"><a href="introduction-to-survival.html#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="introduction-to-survival.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="introduction-to-survival.html#cb3-5" tabindex="-1"></a><span class="co"># Create a Kaplan-Meier Survival Curve with Censoring </span></span>
<span id="cb3-6"><a href="introduction-to-survival.html#cb3-6" tabindex="-1"></a>simple_km<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(<span class="at">time =</span> tenure, <span class="at">event =</span> censored)<span class="sc">~</span><span class="dv">1</span>,                      <span class="at">data =</span> simple)</span>
<span id="cb3-7"><a href="introduction-to-survival.html#cb3-7" tabindex="-1"></a><span class="fu">summary</span>(simple_km)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(time = tenure, event = censored) ~ 1, 
##     data = simple)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     2      6       1    0.833   0.152       0.5827            1
##     3      5       1    0.667   0.192       0.3786            1
##     7      3       1    0.444   0.222       0.1668            1
##     8      2       1    0.222   0.192       0.0407            1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="introduction-to-survival.html#cb5-1" tabindex="-1"></a><span class="fu">plot</span>(simple_km, <span class="at">main =</span> <span class="st">&quot;Survival Function&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tenure&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Survival Probability&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/survival%20curves-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="introduction-to-survival.html#cb6-1" tabindex="-1"></a>loyalty.fit<span class="ot">=</span><span class="fu">survfit</span>(<span class="fu">Surv</span>(Tenure, censored)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>loyalty)</span>
<span id="cb6-2"><a href="introduction-to-survival.html#cb6-2" tabindex="-1"></a><span class="fu">summary</span>(loyalty.fit)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(Tenure, censored) ~ 1, data = loyalty)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     1    250       2   0.9920 0.00563      0.98102        1.000
##     2    245       5   0.9718 0.01052      0.95135        0.993
##     3    235       8   0.9387 0.01535      0.90907        0.969
##     4    220       5   0.9173 0.01772      0.88327        0.953
##     5    207       4   0.8996 0.01946      0.86226        0.939
##     6    197       2   0.8905 0.02031      0.85155        0.931
##     7    189       1   0.8858 0.02074      0.84603        0.927
##     8    177       6   0.8557 0.02338      0.81112        0.903
##     9    169       4   0.8355 0.02493      0.78804        0.886
##    10    160       1   0.8303 0.02531      0.78211        0.881
##    11    156       4   0.8090 0.02681      0.75811        0.863
##    12    144       2   0.7977 0.02759      0.74547        0.854
##    13    137       5   0.7686 0.02949      0.71294        0.829
##    14    128       2   0.7566 0.03023      0.69963        0.818
##    15    120       6   0.7188 0.03242      0.65796        0.785
##    16    107       3   0.6986 0.03354      0.63590        0.768
##    17    103       1   0.6919 0.03389      0.62851        0.762
##    18     96       1   0.6846 0.03430      0.62062        0.755
##    19     94       2   0.6701 0.03508      0.60473        0.742
##    20     89       2   0.6550 0.03587      0.58836        0.729
##    21     86       1   0.6474 0.03625      0.58011        0.723
##    22     82       2   0.6316 0.03705      0.56302        0.709
##    23     76       1   0.6233 0.03748      0.55400        0.701
##    24     73       1   0.6148 0.03793      0.54474        0.694
##    25     71       3   0.5888 0.03918      0.51680        0.671
##    27     63       1   0.5794 0.03966      0.50671        0.663
##    28     59       2   0.5598 0.04067      0.48550        0.645
##    29     57       2   0.5402 0.04155      0.46457        0.628
##    30     54       1   0.5302 0.04197      0.45397        0.619
##    31     52       2   0.5098 0.04276      0.43249        0.601
##    32     50       3   0.4792 0.04369      0.40077        0.573
##    35     44       3   0.4465 0.04459      0.36713        0.543
##    36     40       3   0.4130 0.04525      0.33321        0.512
##    42     31       1   0.3997 0.04571      0.31944        0.500
##    43     29       1   0.3859 0.04616      0.30526        0.488
##    44     27       1   0.3716 0.04661      0.29062        0.475
##    48     24       1   0.3561 0.04717      0.27471        0.462
##    51     18       1   0.3364 0.04852      0.25351        0.446
##    53     17       1   0.3166 0.04954      0.23295        0.430
##    60     12       1   0.2902 0.05196      0.20429        0.412
##    64     11       1   0.2638 0.05352      0.17726        0.393
##    78      8       1   0.2308 0.05607      0.14339        0.372
##    80      7       1   0.1979 0.05694      0.11256        0.348
##    83      6       1   0.1649 0.05619      0.08454        0.322
##    95      4       1   0.1237 0.05523      0.05153        0.297
##   105      3       1   0.0824 0.04988      0.02518        0.270
##   114      2       1   0.0412 0.03836      0.00665        0.255
##   129      1       1   0.0000     NaN           NA           NA</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="introduction-to-survival.html#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(loyalty.fit)</span>
<span id="cb8-2"><a href="introduction-to-survival.html#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="introduction-to-survival.html#cb8-3" tabindex="-1"></a>recid.fit <span class="ot">=</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(week, arrest)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>recid)</span>
<span id="cb8-4"><a href="introduction-to-survival.html#cb8-4" tabindex="-1"></a><span class="fu">summary</span>(recid.fit)</span></code></pre></div>
<pre><code>## Call: survfit(formula = Surv(week, arrest) ~ 1, data = recid)
## 
##  time n.risk n.event survival std.err lower 95% CI upper 95% CI
##     1    432       1    0.998 0.00231        0.993        1.000
##     2    431       1    0.995 0.00327        0.989        1.000
##     3    430       1    0.993 0.00400        0.985        1.000
##     4    429       1    0.991 0.00461        0.982        1.000
##     5    428       1    0.988 0.00515        0.978        0.999
##     6    427       1    0.986 0.00563        0.975        0.997
##     7    426       1    0.984 0.00607        0.972        0.996
##     8    425       5    0.972 0.00791        0.957        0.988
##     9    420       2    0.968 0.00852        0.951        0.984
##    10    418       1    0.965 0.00881        0.948        0.983
##    11    417       2    0.961 0.00935        0.942        0.979
##    12    415       2    0.956 0.00987        0.937        0.976
##    13    413       1    0.954 0.01011        0.934        0.974
##    14    412       3    0.947 0.01080        0.926        0.968
##    15    409       2    0.942 0.01123        0.920        0.964
##    16    407       2    0.937 0.01165        0.915        0.961
##    17    405       3    0.931 0.01223        0.907        0.955
##    18    402       3    0.924 0.01278        0.899        0.949
##    19    399       2    0.919 0.01313        0.894        0.945
##    20    397       5    0.907 0.01395        0.880        0.935
##    21    392       2    0.903 0.01425        0.875        0.931
##    22    390       1    0.900 0.01440        0.873        0.929
##    23    389       1    0.898 0.01455        0.870        0.927
##    24    388       4    0.889 0.01512        0.860        0.919
##    25    384       3    0.882 0.01552        0.852        0.913
##    26    381       3    0.875 0.01591        0.844        0.907
##    27    378       2    0.870 0.01616        0.839        0.903
##    28    376       2    0.866 0.01640        0.834        0.898
##    30    374       2    0.861 0.01664        0.829        0.894
##    31    372       1    0.859 0.01675        0.827        0.892
##    32    371       2    0.854 0.01698        0.822        0.888
##    33    369       2    0.850 0.01720        0.816        0.884
##    34    367       2    0.845 0.01742        0.811        0.880
##    35    365       4    0.836 0.01783        0.801        0.871
##    36    361       3    0.829 0.01813        0.794        0.865
##    37    358       4    0.819 0.01851        0.784        0.857
##    38    354       1    0.817 0.01860        0.781        0.854
##    39    353       2    0.812 0.01878        0.777        0.850
##    40    351       4    0.803 0.01913        0.767        0.842
##    42    347       2    0.799 0.01929        0.762        0.837
##    43    345       4    0.789 0.01962        0.752        0.829
##    44    341       2    0.785 0.01977        0.747        0.824
##    45    339       2    0.780 0.01993        0.742        0.820
##    46    337       4    0.771 0.02022        0.732        0.812
##    47    333       1    0.769 0.02029        0.730        0.809
##    48    332       2    0.764 0.02043        0.725        0.805
##    49    330       5    0.752 0.02077        0.713        0.794
##    50    325       3    0.745 0.02096        0.705        0.788
##    52    322       4    0.736 0.02121        0.696        0.779</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="introduction-to-survival.html#cb10-1" tabindex="-1"></a><span class="fu">ggsurvplot</span>(recid.fit, <span class="at">data =</span> recid, <span class="at">conf.int =</span> T, <span class="at">palette =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Week&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Survival Probability&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>, <span class="at">break.y.by =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/survival%20curves-2.png" width="672" /><img src="bookdownproj_files/figure-html/survival%20curves-3.png" width="672" /></p>
<div id="python-for-survival-curves" class="section level3 hasAnchor" number="2.0.1">
<h3><span class="header-section-number">2.0.1</span> Python for Survival Curves<a href="introduction-to-survival.html#python-for-survival-curves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="introduction-to-survival.html#cb11-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="introduction-to-survival.html#cb11-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb11-3"><a href="introduction-to-survival.html#cb11-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-4"><a href="introduction-to-survival.html#cb11-4" tabindex="-1"></a><span class="im">from</span> sksurv.nonparametric <span class="im">import</span> kaplan_meier_estimator</span>
<span id="cb11-5"><a href="introduction-to-survival.html#cb11-5" tabindex="-1"></a><span class="im">from</span> lifelines <span class="im">import</span> KaplanMeierFitter</span>
<span id="cb11-6"><a href="introduction-to-survival.html#cb11-6" tabindex="-1"></a><span class="im">from</span> lifelines <span class="im">import</span> NelsonAalenFitter</span>
<span id="cb11-7"><a href="introduction-to-survival.html#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="introduction-to-survival.html#cb11-8" tabindex="-1"></a>simple<span class="op">=</span>pd.DataFrame(data<span class="op">=</span>{<span class="st">&#39;Censored&#39;</span>: [<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>], <span class="st">&#39;Tenure&#39;</span>: [<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>]})</span>
<span id="cb11-9"><a href="introduction-to-survival.html#cb11-9" tabindex="-1"></a>km <span class="op">=</span> KaplanMeierFitter()</span>
<span id="cb11-10"><a href="introduction-to-survival.html#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="introduction-to-survival.html#cb11-11" tabindex="-1"></a>km.fit(durations <span class="op">=</span> simple[<span class="st">&#39;Tenure&#39;</span>],event_observed<span class="op">=</span>simple[<span class="st">&#39;Censored&#39;</span>])</span></code></pre></div>
<pre><code>## &lt;lifelines.KaplanMeierFitter:&quot;KM_estimate&quot;, fitted with 6 total observations, 2 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="introduction-to-survival.html#cb13-1" tabindex="-1"></a>km.event_table</span></code></pre></div>
<pre><code>##           removed  observed  censored  entrance  at_risk
## event_at                                                
## 0.0             0         0         0         6        6
## 2.0             1         1         0         0        6
## 3.0             2         1         1         0        5
## 7.0             1         1         0         0        3
## 8.0             1         1         0         0        2
## 10.0            1         0         1         0        1</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="introduction-to-survival.html#cb15-1" tabindex="-1"></a>km.survival_function_</span></code></pre></div>
<pre><code>##           KM_estimate
## timeline             
## 0.0          1.000000
## 2.0          0.833333
## 3.0          0.666667
## 7.0          0.444444
## 8.0          0.222222
## 10.0         0.222222</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="introduction-to-survival.html#cb17-1" tabindex="-1"></a>km.plot()</span>
<span id="cb17-2"><a href="introduction-to-survival.html#cb17-2" tabindex="-1"></a>plt.title(<span class="st">&quot;Survival Plot using K-M&quot;</span>)</span>
<span id="cb17-3"><a href="introduction-to-survival.html#cb17-3" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;Probability&quot;</span>)</span>
<span id="cb17-4"><a href="introduction-to-survival.html#cb17-4" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="introduction-to-survival.html#cb18-1" tabindex="-1"></a>km.plot_cumulative_density()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
</div>
<div id="stratified-analysis" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Stratified Analysis<a href="introduction-to-survival.html#stratified-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can look at Survival curves segmented into different groups or strata (if we want to see if the likelihood of survival changes based on what group you are in). You need to define the variable that creates the strata in order to create this analysis. As always, to truly see if there is a difference, you should perform a statistical analysis test (there are two different tests illustrated in the following code).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="introduction-to-survival.html#cb19-1" tabindex="-1"></a>Loyal.KP2 <span class="ot">=</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(Tenure, censored) <span class="sc">~</span> Loyalty,<span class="at">data=</span>loyalty)</span>
<span id="cb19-2"><a href="introduction-to-survival.html#cb19-2" tabindex="-1"></a><span class="fu">ggsurvplot</span>(Loyal.KP2,<span class="at">data=</span>loyalty,<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;orange&quot;</span>),<span class="at">conf.int =</span> T)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/stratified%20analysis-5.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="introduction-to-survival.html#cb20-1" tabindex="-1"></a>Recid.KP <span class="ot">=</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> wexp,<span class="at">data=</span>recid)</span>
<span id="cb20-2"><a href="introduction-to-survival.html#cb20-2" tabindex="-1"></a><span class="fu">ggsurvplot</span>(Recid.KP,<span class="at">data=</span>recid,<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;orange&quot;</span>),<span class="at">conf.int =</span> T,<span class="at">legend.title =</span> <span class="st">&quot;work experience&quot;</span>, <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/stratified%20analysis-6.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="introduction-to-survival.html#cb21-1" tabindex="-1"></a><span class="co"># Test for Differences in Survival Curves #</span></span>
<span id="cb21-2"><a href="introduction-to-survival.html#cb21-2" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Tenure, censored) <span class="sc">~</span> Loyalty, <span class="at">data=</span>loyalty, <span class="at">rho=</span><span class="dv">0</span>) </span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(Tenure, censored) ~ Loyalty, data = loyalty, 
##     rho = 0)
## 
##             N Observed Expected (O-E)^2/E (O-E)^2/V
## Loyalty=0 183       67       65    0.0595     0.176
## Loyalty=1  67       39       41    0.0944     0.176
## 
##  Chisq= 0.2  on 1 degrees of freedom, p= 0.7</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="introduction-to-survival.html#cb23-1" tabindex="-1"></a><span class="co"># Log-Rank Test </span></span>
<span id="cb23-2"><a href="introduction-to-survival.html#cb23-2" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(Tenure, censored) <span class="sc">~</span> Loyalty, <span class="at">data=</span>loyalty, <span class="at">rho=</span><span class="dv">1</span>) </span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(Tenure, censored) ~ Loyalty, data = loyalty, 
##     rho = 1)
## 
##             N Observed Expected (O-E)^2/E (O-E)^2/V
## Loyalty=0 183     49.6     49.3   0.00155    0.0063
## Loyalty=1  67     24.9     25.1   0.00303    0.0063
## 
##  Chisq= 0  on 1 degrees of freedom, p= 0.9</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="introduction-to-survival.html#cb25-1" tabindex="-1"></a><span class="co"># Wilcoxon Test </span></span>
<span id="cb25-2"><a href="introduction-to-survival.html#cb25-2" tabindex="-1"></a></span>
<span id="cb25-3"><a href="introduction-to-survival.html#cb25-3" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> wexp, <span class="at">data=</span>recid,<span class="at">rho=</span><span class="dv">0</span>) <span class="co"># Log-Rank Test </span></span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(week, arrest) ~ wexp, data = recid, rho = 0)
## 
##          N Observed Expected (O-E)^2/E (O-E)^2/V
## wexp=0 185       62     45.6      5.91      9.91
## wexp=1 247       52     68.4      3.94      9.91
## 
##  Chisq= 9.9  on 1 degrees of freedom, p= 0.002</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="introduction-to-survival.html#cb27-1" tabindex="-1"></a><span class="fu">survdiff</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> wexp,<span class="at">data=</span>recid,<span class="at">rho=</span><span class="dv">1</span>) <span class="co"># Wilcoxon Test </span></span></code></pre></div>
<pre><code>## Call:
## survdiff(formula = Surv(week, arrest) ~ wexp, data = recid, rho = 1)
## 
##          N Observed Expected (O-E)^2/E (O-E)^2/V
## wexp=0 185     55.0     39.9      5.75        11
## wexp=1 247     44.4     59.5      3.85        11
## 
##  Chisq= 11  on 1 degrees of freedom, p= 9e-04</code></pre>
<div id="python-for-stratified-analysis" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Python for stratified analysis<a href="introduction-to-survival.html#python-for-stratified-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="introduction-to-survival.html#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="introduction-to-survival.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="introduction-to-survival.html#cb29-3" tabindex="-1"></a>loyalty<span class="op">=</span>pd.read_csv(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/loyalty.csv&quot;</span>)</span>
<span id="cb29-4"><a href="introduction-to-survival.html#cb29-4" tabindex="-1"></a></span>
<span id="cb29-5"><a href="introduction-to-survival.html#cb29-5" tabindex="-1"></a>cen_loy<span class="op">=</span>loyalty[<span class="st">&quot;censored&quot;</span>]</span>
<span id="cb29-6"><a href="introduction-to-survival.html#cb29-6" tabindex="-1"></a>time_loy<span class="op">=</span>loyalty[<span class="st">&quot;Tenure&quot;</span>]</span>
<span id="cb29-7"><a href="introduction-to-survival.html#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="introduction-to-survival.html#cb29-8" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb29-9"><a href="introduction-to-survival.html#cb29-9" tabindex="-1"></a></span>
<span id="cb29-10"><a href="introduction-to-survival.html#cb29-10" tabindex="-1"></a>loy <span class="op">=</span> (loyalty[<span class="st">&quot;Loyalty&quot;</span>] <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb29-11"><a href="introduction-to-survival.html#cb29-11" tabindex="-1"></a>kmf <span class="op">=</span> KaplanMeierFitter()</span>
<span id="cb29-12"><a href="introduction-to-survival.html#cb29-12" tabindex="-1"></a>kmf.fit(time_loy[loy], event_observed<span class="op">=</span>cen_loy[loy], label<span class="op">=</span><span class="st">&quot;No program&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;lifelines.KaplanMeierFitter:&quot;No program&quot;, fitted with 183 total observations, 116 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="introduction-to-survival.html#cb31-1" tabindex="-1"></a>kmf.plot_survival_function(ax<span class="op">=</span>ax)</span>
<span id="cb31-2"><a href="introduction-to-survival.html#cb31-2" tabindex="-1"></a></span>
<span id="cb31-3"><a href="introduction-to-survival.html#cb31-3" tabindex="-1"></a>kmf.fit(time_loy[<span class="op">~</span>loy], event_observed<span class="op">=</span>cen_loy[<span class="op">~</span>loy], label<span class="op">=</span><span class="st">&quot;Program members&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;lifelines.KaplanMeierFitter:&quot;Program members&quot;, fitted with 67 total observations, 28 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="introduction-to-survival.html#cb33-1" tabindex="-1"></a>kmf.plot_survival_function(ax<span class="op">=</span>ax)</span>
<span id="cb33-2"><a href="introduction-to-survival.html#cb33-2" tabindex="-1"></a></span>
<span id="cb33-3"><a href="introduction-to-survival.html#cb33-3" tabindex="-1"></a>plt.title(<span class="st">&quot;Loyalty program&quot;</span>)</span>
<span id="cb33-4"><a href="introduction-to-survival.html#cb33-4" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Using the recidivism data set.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="introduction-to-survival.html#cb34-1" tabindex="-1"></a>recid <span class="op">=</span> pd.read_csv(<span class="st">&quot;https://raw.githubusercontent.com/sjsimmo2/Survival/master/recid.csv&quot;</span>)</span>
<span id="cb34-2"><a href="introduction-to-survival.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="introduction-to-survival.html#cb34-3" tabindex="-1"></a>cen_recid<span class="op">=</span>recid[<span class="st">&quot;arrest&quot;</span>]</span>
<span id="cb34-4"><a href="introduction-to-survival.html#cb34-4" tabindex="-1"></a>time_recid<span class="op">=</span>recid[<span class="st">&quot;week&quot;</span>]</span>
<span id="cb34-5"><a href="introduction-to-survival.html#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="introduction-to-survival.html#cb34-6" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">111</span>)</span>
<span id="cb34-7"><a href="introduction-to-survival.html#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="introduction-to-survival.html#cb34-8" tabindex="-1"></a>no_work <span class="op">=</span> (recid[<span class="st">&quot;wexp&quot;</span>] <span class="op">==</span> <span class="dv">0</span>)</span>
<span id="cb34-9"><a href="introduction-to-survival.html#cb34-9" tabindex="-1"></a>kmf <span class="op">=</span> KaplanMeierFitter()</span>
<span id="cb34-10"><a href="introduction-to-survival.html#cb34-10" tabindex="-1"></a>kmf.fit(time_recid[no_work], event_observed<span class="op">=</span>cen_recid[no_work], label<span class="op">=</span><span class="st">&quot;No prior work&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;lifelines.KaplanMeierFitter:&quot;No prior work&quot;, fitted with 185 total observations, 123 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="introduction-to-survival.html#cb36-1" tabindex="-1"></a>kmf.plot_survival_function(ax<span class="op">=</span>ax)</span>
<span id="cb36-2"><a href="introduction-to-survival.html#cb36-2" tabindex="-1"></a></span>
<span id="cb36-3"><a href="introduction-to-survival.html#cb36-3" tabindex="-1"></a>kmf.fit(time_recid[<span class="op">~</span>no_work], event_observed<span class="op">=</span>cen_recid[<span class="op">~</span>no_work], label<span class="op">=</span><span class="st">&quot;Work experience&quot;</span>)</span></code></pre></div>
<pre><code>## &lt;lifelines.KaplanMeierFitter:&quot;Work experience&quot;, fitted with 247 total observations, 195 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="introduction-to-survival.html#cb38-1" tabindex="-1"></a>kmf.plot_survival_function(ax<span class="op">=</span>ax)</span>
<span id="cb38-2"><a href="introduction-to-survival.html#cb38-2" tabindex="-1"></a></span>
<span id="cb38-3"><a href="introduction-to-survival.html#cb38-3" tabindex="-1"></a>plt.title(<span class="st">&quot;Work experience&quot;</span>)</span>
<span id="cb38-4"><a href="introduction-to-survival.html#cb38-4" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
</div>
</div>
<div id="hazard-function" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Hazard function<a href="introduction-to-survival.html#hazard-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are able to calculate hazard probabilities and cumulative hazard functions in R.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="introduction-to-survival.html#cb39-1" tabindex="-1"></a><span class="co"># Calculating Hazard Probabilities </span></span>
<span id="cb39-2"><a href="introduction-to-survival.html#cb39-2" tabindex="-1"></a>h<span class="ot">=</span> simple_km<span class="sc">$</span>n.event<span class="sc">/</span>simple_km<span class="sc">$</span>n.risk</span>
<span id="cb39-3"><a href="introduction-to-survival.html#cb39-3" tabindex="-1"></a>index.h<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">length=</span>(<span class="fu">max</span>(simple<span class="sc">$</span>tenure)<span class="sc">+</span><span class="dv">1</span>)) <span class="co">#Need to add 0</span></span>
<span id="cb39-4"><a href="introduction-to-survival.html#cb39-4" tabindex="-1"></a>index.h[(simple_km<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span>h <span class="co">#Because of 0</span></span>
<span id="cb39-5"><a href="introduction-to-survival.html#cb39-5" tabindex="-1"></a>haz.plot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(simple<span class="sc">$</span>tenure)), index.h))</span>
<span id="cb39-6"><a href="introduction-to-survival.html#cb39-6" tabindex="-1"></a><span class="fu">colnames</span>(haz.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Hazard&quot;</span>)</span>
<span id="cb39-7"><a href="introduction-to-survival.html#cb39-7" tabindex="-1"></a><span class="fu">ggplot</span>(haz.plot,<span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Hazard))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-5.png" width="672" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="introduction-to-survival.html#cb40-1" tabindex="-1"></a>h <span class="ot">=</span> loyalty.fit<span class="sc">$</span>n.event<span class="sc">/</span>loyalty.fit<span class="sc">$</span>n.risk</span>
<span id="cb40-2"><a href="introduction-to-survival.html#cb40-2" tabindex="-1"></a>index.h<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">length=</span>(<span class="fu">max</span>(loyalty<span class="sc">$</span>Tenure)<span class="sc">+</span><span class="dv">1</span>)) <span class="co">#Need to add 0</span></span>
<span id="cb40-3"><a href="introduction-to-survival.html#cb40-3" tabindex="-1"></a>index.h[(loyalty.fit<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span>h <span class="co">#Because of 0</span></span>
<span id="cb40-4"><a href="introduction-to-survival.html#cb40-4" tabindex="-1"></a>haz.plot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(loyalty<span class="sc">$</span>Tenure)), index.h))</span>
<span id="cb40-5"><a href="introduction-to-survival.html#cb40-5" tabindex="-1"></a><span class="fu">colnames</span>(haz.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Hazard&quot;</span>)</span>
<span id="cb40-6"><a href="introduction-to-survival.html#cb40-6" tabindex="-1"></a><span class="fu">ggplot</span>(haz.plot,<span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Hazard))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-6.png" width="672" /></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="introduction-to-survival.html#cb41-1" tabindex="-1"></a>h <span class="ot">=</span> recid.fit<span class="sc">$</span>n.event<span class="sc">/</span>recid.fit<span class="sc">$</span>n.risk</span>
<span id="cb41-2"><a href="introduction-to-survival.html#cb41-2" tabindex="-1"></a>index.h<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">length=</span>(<span class="fu">max</span>(recid<span class="sc">$</span>week)<span class="sc">+</span><span class="dv">1</span>)) <span class="co">#Need to add 0</span></span>
<span id="cb41-3"><a href="introduction-to-survival.html#cb41-3" tabindex="-1"></a>index.h[(recid.fit<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span>h <span class="co">#Because of 0</span></span>
<span id="cb41-4"><a href="introduction-to-survival.html#cb41-4" tabindex="-1"></a>haz.plot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(recid<span class="sc">$</span>week)), index.h))</span>
<span id="cb41-5"><a href="introduction-to-survival.html#cb41-5" tabindex="-1"></a><span class="fu">colnames</span>(haz.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Hazard&quot;</span>)</span>
<span id="cb41-6"><a href="introduction-to-survival.html#cb41-6" tabindex="-1"></a><span class="fu">ggplot</span>(haz.plot,<span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Hazard))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-7.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="introduction-to-survival.html#cb42-1" tabindex="-1"></a><span class="fu">ggsurvplot</span>(recid.fit, <span class="at">data =</span> recid, <span class="at">fun =</span> <span class="st">&quot;cumhaz&quot;</span>, <span class="at">conf.int =</span> <span class="cn">TRUE</span>,  <span class="at">palette =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Week&quot;</span>,           <span class="at">ylab =</span> <span class="st">&quot;Cumulative Hazard&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-8.png" width="672" /></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="introduction-to-survival.html#cb43-1" tabindex="-1"></a><span class="do">###Cumulative hazard function</span></span>
<span id="cb43-2"><a href="introduction-to-survival.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="introduction-to-survival.html#cb43-3" tabindex="-1"></a>h<span class="ot">=</span> simple_km<span class="sc">$</span>n.event<span class="sc">/</span>simple_km<span class="sc">$</span>n.risk</span>
<span id="cb43-4"><a href="introduction-to-survival.html#cb43-4" tabindex="-1"></a>index.h<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="at">length=</span>(<span class="fu">max</span>(simple<span class="sc">$</span>tenure)<span class="sc">+</span><span class="dv">1</span>)) <span class="co">#Need to add 0</span></span>
<span id="cb43-5"><a href="introduction-to-survival.html#cb43-5" tabindex="-1"></a>index.h[(simple_km<span class="sc">$</span>time)<span class="sc">+</span><span class="dv">1</span>]<span class="ot">=</span>h <span class="co">#Because of 0</span></span>
<span id="cb43-6"><a href="introduction-to-survival.html#cb43-6" tabindex="-1"></a>cum.haz<span class="ot">=</span><span class="fu">cumsum</span>(index.h)</span>
<span id="cb43-7"><a href="introduction-to-survival.html#cb43-7" tabindex="-1"></a>haz.plot<span class="ot">=</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(simple<span class="sc">$</span>tenure)), cum.haz))</span>
<span id="cb43-8"><a href="introduction-to-survival.html#cb43-8" tabindex="-1"></a><span class="fu">colnames</span>(haz.plot)<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;Time&quot;</span>,<span class="st">&quot;Hazard&quot;</span>)</span>
<span id="cb43-9"><a href="introduction-to-survival.html#cb43-9" tabindex="-1"></a><span class="fu">ggplot</span>(haz.plot,<span class="fu">aes</span>(<span class="at">x=</span>Time,<span class="at">y=</span>Hazard))<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Cumulative Hazard&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-9.png" width="672" /></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="introduction-to-survival.html#cb44-1" tabindex="-1"></a><span class="fu">ggsurvplot</span>(</span>
<span id="cb44-2"><a href="introduction-to-survival.html#cb44-2" tabindex="-1"></a>  Recid.KP,</span>
<span id="cb44-3"><a href="introduction-to-survival.html#cb44-3" tabindex="-1"></a>  <span class="at">data =</span> recid,</span>
<span id="cb44-4"><a href="introduction-to-survival.html#cb44-4" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,                 </span>
<span id="cb44-5"><a href="introduction-to-survival.html#cb44-5" tabindex="-1"></a>  <span class="at">palette =</span></span>
<span id="cb44-6"><a href="introduction-to-survival.html#cb44-6" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;orange&quot;</span>),</span>
<span id="cb44-7"><a href="introduction-to-survival.html#cb44-7" tabindex="-1"></a>  <span class="at">conf.int =</span> <span class="cn">TRUE</span>,          </span>
<span id="cb44-8"><a href="introduction-to-survival.html#cb44-8" tabindex="-1"></a>  <span class="at">pval =</span> <span class="cn">TRUE</span>,              </span>
<span id="cb44-9"><a href="introduction-to-survival.html#cb44-9" tabindex="-1"></a>  <span class="at">risk.table =</span> <span class="cn">TRUE</span>,        </span>
<span id="cb44-10"><a href="introduction-to-survival.html#cb44-10" tabindex="-1"></a>  <span class="at">risk.table.col =</span> <span class="st">&quot;wexp&quot;</span>,</span>
<span id="cb44-11"><a href="introduction-to-survival.html#cb44-11" tabindex="-1"></a>  <span class="at">legend.labs =</span></span>
<span id="cb44-12"><a href="introduction-to-survival.html#cb44-12" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>),    </span>
<span id="cb44-13"><a href="introduction-to-survival.html#cb44-13" tabindex="-1"></a>  <span class="at">risk.table.height =</span> <span class="fl">0.25</span>, </span>
<span id="cb44-14"><a href="introduction-to-survival.html#cb44-14" tabindex="-1"></a>  <span class="at">ggtheme =</span> <span class="fu">theme_bw</span>()      </span>
<span id="cb44-15"><a href="introduction-to-survival.html#cb44-15" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hazard%20functions-10.png" width="672" /></p>
<div id="python-for-hazard-function" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Python for Hazard function<a href="introduction-to-survival.html#python-for-hazard-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="introduction-to-survival.html#cb45-1" tabindex="-1"></a></span>
<span id="cb45-2"><a href="introduction-to-survival.html#cb45-2" tabindex="-1"></a>km_val <span class="op">=</span> km.event_table</span>
<span id="cb45-3"><a href="introduction-to-survival.html#cb45-3" tabindex="-1"></a></span>
<span id="cb45-4"><a href="introduction-to-survival.html#cb45-4" tabindex="-1"></a>hazard <span class="op">=</span> km_val.observed<span class="op">/</span>km_val.at_risk</span>
<span id="cb45-5"><a href="introduction-to-survival.html#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="introduction-to-survival.html#cb45-6" tabindex="-1"></a>hazard</span></code></pre></div>
<pre><code>## event_at
## 0.0     0.000000
## 2.0     0.166667
## 3.0     0.200000
## 7.0     0.333333
## 8.0     0.500000
## 10.0    0.000000
## dtype: float64</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="introduction-to-survival.html#cb47-1" tabindex="-1"></a>cum_haz<span class="op">=</span>NelsonAalenFitter()</span>
<span id="cb47-2"><a href="introduction-to-survival.html#cb47-2" tabindex="-1"></a>cum_haz.fit(durations <span class="op">=</span> simple[<span class="st">&#39;Tenure&#39;</span>],event_observed<span class="op">=</span>simple[<span class="st">&#39;Censored&#39;</span>])</span></code></pre></div>
<pre><code>## &lt;lifelines.NelsonAalenFitter:&quot;NA_estimate&quot;, fitted with 6 total observations, 2 right-censored observations&gt;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="introduction-to-survival.html#cb49-1" tabindex="-1"></a>cum_haz.plot_cumulative_hazard()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="accelerated-failure-time-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sjsimmo2/Survival/edit/master/02-Intro.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/sjsimmo2/Survival/blob/master/02-Intro.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

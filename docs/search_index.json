[["competing-risks.html", "Chapter 2 Competing Risks", " Chapter 2 Competing Risks The following code illustrates how to do a competing risk model. leaders$lost = factor(leaders$lost, 0:3, labels = c(&quot;In-Office&quot;, &quot;Constitutional&quot;, &quot;Natural&quot;, &quot;Non-Constitutional&quot;)) # Cumulative Incidence Functions # cif.dat=leaders[leaders$lost!=&quot;In-Office&quot;,] cif.tenure=cif.dat$years cif.status=cif.dat$lost cif.leaders=cuminc(cif.tenure,cif.status,rho=0) ggcompetingrisks(cif.leaders) # Cox Regression Competing Risks # tenure=leaders$years View(leaders) status.leaders=leaders$lost x=leaders[,3:12] x$africa=ifelse(leaders$region==1,1,0) x$asia=ifelse(leaders$region==2,1,0) x$latin=ifelse(leaders$region==3,1,0) gray.natural=crr(tenure,status.leaders,x,failcode=&quot;Natural&quot;) ## 34 cases omitted due to missing values summary(gray.natural) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Natural&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner -7.32e-02 0.929 0.562617 -0.13007 0.9000 ## start -8.33e-02 0.920 0.026453 -3.14757 0.0016 ## military -2.51e-01 0.778 0.549101 -0.45674 0.6500 ## age 4.75e-02 1.049 0.018127 2.62190 0.0087 ## conflict -2.13e-03 0.998 0.440003 -0.00484 1.0000 ## loginc 5.55e-01 1.741 0.261591 2.11995 0.0340 ## growth 9.80e-02 1.103 0.128218 0.76408 0.4400 ## pop 2.41e-03 1.002 0.002784 0.86500 0.3900 ## land -8.76e-05 1.000 0.000189 -0.46445 0.6400 ## literacy -6.71e-03 0.993 0.011000 -0.60956 0.5400 ## africa 4.44e-01 1.559 0.710063 0.62578 0.5300 ## asia -6.97e-01 0.498 0.821035 -0.84936 0.4000 ## latin 1.22e-01 1.129 0.625890 0.19434 0.8500 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 0.929 1.076 0.3085 2.800 ## start 0.920 1.087 0.8736 0.969 ## military 0.778 1.285 0.2653 2.283 ## age 1.049 0.954 1.0121 1.087 ## conflict 0.998 1.002 0.4213 2.364 ## loginc 1.741 0.574 1.0427 2.907 ## growth 1.103 0.907 0.8578 1.418 ## pop 1.002 0.998 0.9970 1.008 ## land 1.000 1.000 0.9995 1.000 ## literacy 0.993 1.007 0.9721 1.015 ## africa 1.559 0.641 0.3878 6.272 ## asia 0.498 2.008 0.0996 2.489 ## latin 1.129 0.885 0.3312 3.851 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -149 ## Pseudo likelihood ratio test = 29.4 on 13 df, gray.const=crr(tenure,status.leaders,x,failcode=&quot;Constitutional&quot;) ## 34 cases omitted due to missing values summary(gray.const) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Constitutional&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner -6.20e-01 0.538 2.64e-01 -2.34926 0.0190 ## start -1.79e-02 0.982 9.79e-03 -1.83105 0.0670 ## military 1.22e-01 1.130 2.49e-01 0.48991 0.6200 ## age 1.37e-02 1.014 8.45e-03 1.61657 0.1100 ## conflict -1.67e-01 0.846 2.16e-01 -0.77554 0.4400 ## loginc -1.35e-01 0.874 1.15e-01 -1.17732 0.2400 ## growth 4.18e-02 1.043 3.02e-02 1.38457 0.1700 ## pop 6.68e-04 1.001 8.78e-04 0.76086 0.4500 ## land -2.74e-05 1.000 6.89e-05 -0.39672 0.6900 ## literacy 1.88e-02 1.019 5.77e-03 3.25010 0.0012 ## africa -9.43e-01 0.389 3.94e-01 -2.39044 0.0170 ## asia -3.18e-03 0.997 3.69e-01 -0.00862 0.9900 ## latin 8.25e-02 1.086 3.54e-01 0.23284 0.8200 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 0.538 1.859 0.321 0.902 ## start 0.982 1.018 0.964 1.001 ## military 1.130 0.885 0.693 1.841 ## age 1.014 0.986 0.997 1.031 ## conflict 0.846 1.182 0.554 1.291 ## loginc 0.874 1.145 0.697 1.094 ## growth 1.043 0.959 0.983 1.106 ## pop 1.001 0.999 0.999 1.002 ## land 1.000 1.000 1.000 1.000 ## literacy 1.019 0.981 1.007 1.031 ## africa 0.389 2.568 0.180 0.844 ## asia 0.997 1.003 0.484 2.053 ## latin 1.086 0.921 0.542 2.174 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -814 ## Pseudo likelihood ratio test = 101 on 13 df, gray.nonconst=crr(tenure,status.leaders,x,failcode=&quot;Non-Constitutional&quot;) ## 34 cases omitted due to missing values summary(gray.nonconst) ## Competing Risks Regression ## ## Call: ## crr(ftime = tenure, fstatus = status.leaders, cov1 = x, failcode = &quot;Non-Constitutional&quot;) ## ## coef exp(coef) se(coef) z p-value ## manner 7.87e-01 2.196 0.196832 3.996 6.4e-05 ## start -5.61e-02 0.945 0.010553 -5.315 1.1e-07 ## military -2.40e-01 0.787 0.200255 -1.199 2.3e-01 ## age -1.34e-03 0.999 0.008335 -0.161 8.7e-01 ## conflict 5.35e-01 1.708 0.183801 2.912 3.6e-03 ## loginc -3.05e-01 0.737 0.128953 -2.363 1.8e-02 ## growth -5.26e-02 0.949 0.029720 -1.769 7.7e-02 ## pop -1.13e-03 0.999 0.000879 -1.284 2.0e-01 ## land -2.69e-05 1.000 0.000079 -0.341 7.3e-01 ## literacy -9.43e-03 0.991 0.004066 -2.320 2.0e-02 ## africa -2.15e-01 0.807 0.284876 -0.753 4.5e-01 ## asia -4.99e-01 0.607 0.364670 -1.369 1.7e-01 ## latin 3.67e-01 1.443 0.290395 1.263 2.1e-01 ## ## exp(coef) exp(-coef) 2.5% 97.5% ## manner 2.196 0.455 1.493 3.230 ## start 0.945 1.058 0.926 0.965 ## military 0.787 1.271 0.531 1.165 ## age 0.999 1.001 0.982 1.015 ## conflict 1.708 0.586 1.191 2.448 ## loginc 0.737 1.356 0.573 0.949 ## growth 0.949 1.054 0.895 1.006 ## pop 0.999 1.001 0.997 1.001 ## land 1.000 1.000 1.000 1.000 ## literacy 0.991 1.009 0.983 0.999 ## africa 0.807 1.239 0.462 1.410 ## asia 0.607 1.648 0.297 1.240 ## latin 1.443 0.693 0.817 2.550 ## ## Num. cases = 438 (34 cases omitted due to missing values) ## Pseudo Log-likelihood = -855 ## Pseudo likelihood ratio test = 110 on 13 df, "],["repeated-events.html", "Chapter 3 Repeated Events", " Chapter 3 Repeated Events # Independence Model (Andersen-Gill approach) bladder.td &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size , data = bladder) summary(bladder.td) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size, data = bladder) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) z Pr(&gt;|z|) ## rx -0.46469 0.62833 0.19973 -2.327 0.019989 * ## number 0.17496 1.19120 0.04707 3.717 0.000202 *** ## size -0.04366 0.95728 0.06905 -0.632 0.527196 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.6283 1.5915 0.4248 0.9294 ## number 1.1912 0.8395 1.0862 1.3063 ## size 0.9573 1.0446 0.8361 1.0960 ## ## Concordance= 0.634 (se = 0.032 ) ## Likelihood ratio test= 17.52 on 3 df, p=6e-04 ## Wald test = 19.11 on 3 df, p=3e-04 ## Score (logrank) test = 19.52 on 3 df, p=2e-04 # Independence Model - Marginal means bladder.rse &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size + cluster(id), data = bladder) summary(bladder.rse) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size, data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.46469 0.62833 0.19973 0.26556 -1.750 0.08015 . ## number 0.17496 1.19120 0.04707 0.06304 2.775 0.00551 ** ## size -0.04366 0.95728 0.06905 0.07762 -0.563 0.57376 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.6283 1.5915 0.3734 1.057 ## number 1.1912 0.8395 1.0527 1.348 ## size 0.9573 1.0446 0.8222 1.115 ## ## Concordance= 0.634 (se = 0.032 ) ## Likelihood ratio test= 17.52 on 3 df, p=6e-04 ## Wald test = 11.54 on 3 df, p=0.009 ## Score (logrank) test = 19.52 on 3 df, p=2e-04, Robust = 11.27 p=0.01 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Conditional Model - Assuming Variable Effects Same Across Strata - PWP model bladder.con &lt;- coxph(Surv(start, stop, event == 1) ~ rx + number + size + strata(enum)+cluster(id), data = bladder) summary(bladder.con) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ rx + number + ## size + strata(enum), data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.333489 0.716420 0.216168 0.204787 -1.628 0.1034 ## number 0.119617 1.127065 0.053338 0.051387 2.328 0.0199 * ## size -0.008495 0.991541 0.072762 0.061635 -0.138 0.8904 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.7164 1.3958 0.4796 1.070 ## number 1.1271 0.8873 1.0191 1.246 ## size 0.9915 1.0085 0.8787 1.119 ## ## Concordance= 0.616 (se = 0.032 ) ## Likelihood ratio test= 6.51 on 3 df, p=0.09 ## Wald test = 7.26 on 3 df, p=0.06 ## Score (logrank) test = 6.91 on 3 df, p=0.07, Robust = 8.83 p=0.03 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Conditional Model - Assuming Variable Effects change Across Strata - PWP model bladder.con &lt;- coxph(Surv(start, stop, event == 1) ~ strata(enum)*rx + strata(enum)*number + strata(enum)*size + cluster(id), data = bladder) summary(bladder.con) ## Call: ## coxph(formula = Surv(start, stop, event == 1) ~ strata(enum) + ## rx + number + size + strata(enum):rx + strata(enum):number + ## strata(enum):size, data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.52598 0.59097 0.31583 0.31524 -1.669 0.09521 ## number 0.23818 1.26894 0.07588 0.07459 3.193 0.00141 ## size 0.06961 1.07209 0.10156 0.08863 0.785 0.43220 ## strata(enum)enum=2:rx 0.02215 1.02239 0.51451 0.60852 0.036 0.97097 ## strata(enum)enum=3:rx 0.66664 1.94768 0.74348 0.57671 1.156 0.24771 ## strata(enum)enum=4:rx 0.57632 1.77947 0.85238 0.62678 0.919 0.35784 ## strata(enum)enum=2:number -0.26282 0.76888 0.11763 0.16532 -1.590 0.11189 ## strata(enum)enum=3:number -0.18852 0.82819 0.20026 0.14196 -1.328 0.18420 ## strata(enum)enum=4:number -0.03390 0.96667 0.25366 0.19351 -0.175 0.86092 ## strata(enum)enum=2:size -0.23033 0.79427 0.15910 0.17506 -1.316 0.18827 ## strata(enum)enum=3:size 0.09849 1.10350 0.28757 0.18033 0.546 0.58497 ## strata(enum)enum=4:size -0.06052 0.94128 0.35382 0.37643 -0.161 0.87228 ## ## rx . ## number ** ## size ## strata(enum)enum=2:rx ## strata(enum)enum=3:rx ## strata(enum)enum=4:rx ## strata(enum)enum=2:number ## strata(enum)enum=3:number ## strata(enum)enum=4:number ## strata(enum)enum=2:size ## strata(enum)enum=3:size ## strata(enum)enum=4:size ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.5910 1.6921 0.3186 1.096 ## number 1.2689 0.7881 1.0964 1.469 ## size 1.0721 0.9328 0.9011 1.275 ## strata(enum)enum=2:rx 1.0224 0.9781 0.3102 3.370 ## strata(enum)enum=3:rx 1.9477 0.5134 0.6290 6.031 ## strata(enum)enum=4:rx 1.7795 0.5620 0.5209 6.079 ## strata(enum)enum=2:number 0.7689 1.3006 0.5561 1.063 ## strata(enum)enum=3:number 0.8282 1.2075 0.6270 1.094 ## strata(enum)enum=4:number 0.9667 1.0345 0.6616 1.412 ## strata(enum)enum=2:size 0.7943 1.2590 0.5636 1.119 ## strata(enum)enum=3:size 1.1035 0.9062 0.7750 1.571 ## strata(enum)enum=4:size 0.9413 1.0624 0.4501 1.969 ## ## Concordance= 0.629 (se = 0.036 ) ## Likelihood ratio test= 14.5 on 12 df, p=0.3 ## Wald test = 20.29 on 12 df, p=0.06 ## Score (logrank) test = 15.73 on 12 df, p=0.2, Robust = 15.8 p=0.2 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). # Gap Time Model - Assuming Variable Effects Same Across Strata # # Can easily extend the gap time model to assume variable effects different same as above. # bladder.gap &lt;- coxph(Surv(time = (stop - start), event == 1) ~ rx + number + size + strata(enum) +cluster(id), data = bladder) summary(bladder.gap) ## Call: ## coxph(formula = Surv(time = (stop - start), event == 1) ~ rx + ## number + size + strata(enum), data = bladder, cluster = id) ## ## n= 178, number of events= 112 ## ## coef exp(coef) se(coef) robust se z Pr(&gt;|z|) ## rx -0.279005 0.756536 0.207348 0.215624 -1.294 0.19569 ## number 0.158046 1.171220 0.051942 0.050940 3.103 0.00192 ** ## size 0.007415 1.007443 0.070023 0.064333 0.115 0.90824 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## exp(coef) exp(-coef) lower .95 upper .95 ## rx 0.7565 1.3218 0.4958 1.154 ## number 1.1712 0.8538 1.0599 1.294 ## size 1.0074 0.9926 0.8881 1.143 ## ## Concordance= 0.596 (se = 0.032 ) ## Likelihood ratio test= 9.33 on 3 df, p=0.03 ## Wald test = 11.84 on 3 df, p=0.008 ## Score (logrank) test = 10.27 on 3 df, p=0.02, Robust = 9.92 p=0.02 ## ## (Note: the likelihood ratio and score tests assume independence of ## observations within a cluster, the Wald and robust score tests do not). "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Cox Regression | Survival Analysis</title>
  <meta name="description" content="Chapter 4 Cox Regression | Survival Analysis" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Cox Regression | Survival Analysis" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Cox Regression | Survival Analysis" />
  
  
  

<meta name="author" content="Susan Simmons" />


<meta name="date" content="2022-10-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="aft.html"/>
<link rel="next" href="competing-risks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Survival</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Survival Analysis</a></li>
<li class="chapter" data-level="2" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html"><i class="fa fa-check"></i><b>2</b> Survival Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#stratified-analysis"><i class="fa fa-check"></i><b>2.1</b> Stratified Analysis</a></li>
<li class="chapter" data-level="2.2" data-path="survival-analysis-1.html"><a href="survival-analysis-1.html#hazard-function"><i class="fa fa-check"></i><b>2.2</b> Hazard function</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="aft.html"><a href="aft.html"><i class="fa fa-check"></i><b>3</b> AFT</a>
<ul>
<li class="chapter" data-level="3.1" data-path="aft.html"><a href="aft.html#breaking-down-the-above-code-into-smaller-pieces"><i class="fa fa-check"></i><b>3.1</b> Breaking down the above code into smaller pieces!</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cox-regression.html"><a href="cox-regression.html"><i class="fa fa-check"></i><b>4</b> Cox Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="cox-regression.html"><a href="cox-regression.html#diagnostics"><i class="fa fa-check"></i><b>4.1</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="competing-risks.html"><a href="competing-risks.html"><i class="fa fa-check"></i><b>5</b> Competing Risks</a></li>
<li class="chapter" data-level="6" data-path="repeated-events.html"><a href="repeated-events.html"><i class="fa fa-check"></i><b>6</b> Repeated Events</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Survival Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="cox-regression" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Cox Regression<a href="cox-regression.html#cox-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The following code fits the Proportional Cox Hazard model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="cox-regression.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional Hazards Model #</span></span>
<span id="cb1-2"><a href="cox-regression.html#cb1-2" aria-hidden="true" tabindex="-1"></a>recid.ph <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> wexp <span class="sc">+</span> mar <span class="sc">+</span>paro <span class="sc">+</span> prio, <span class="at">data =</span> recid)</span>
<span id="cb1-3"><a href="cox-regression.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid.ph)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ fin + age + wexp + mar + 
##     paro + prio, data = recid)
## 
##   n= 432, number of events= 114 
## 
##          coef exp(coef) se(coef)      z Pr(&gt;|z|)   
## fin  -0.36554   0.69382  0.19090 -1.915  0.05552 . 
## age  -0.05633   0.94523  0.02189 -2.573  0.01007 * 
## wexp -0.15699   0.85471  0.21208 -0.740  0.45916   
## mar  -0.47130   0.62419  0.38027 -1.239  0.21520   
## paro -0.07792   0.92504  0.19530 -0.399  0.68991   
## prio  0.08966   1.09380  0.02871  3.123  0.00179 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## fin     0.6938     1.4413    0.4773    1.0087
## age     0.9452     1.0579    0.9055    0.9867
## wexp    0.8547     1.1700    0.5640    1.2952
## mar     0.6242     1.6021    0.2962    1.3152
## paro    0.9250     1.0810    0.6308    1.3564
## prio    1.0938     0.9142    1.0340    1.1571
## 
## Concordance= 0.639  (se = 0.027 )
## Likelihood ratio test= 32.14  on 6 df,   p=2e-05
## Wald test            = 30.79  on 6 df,   p=3e-05
## Score (logrank) test = 32.28  on 6 df,   p=1e-05</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="cox-regression.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter Interpretation #</span></span>
<span id="cb3-2"><a href="cox-regression.html#cb3-2" aria-hidden="true" tabindex="-1"></a>recid.ph2 <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> prio, <span class="at">data =</span> recid)</span>
<span id="cb3-3"><a href="cox-regression.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid.ph2)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ fin + age + prio, data = recid)
## 
##   n= 432, number of events= 114 
## 
##          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## fin  -0.34695   0.70684  0.19025 -1.824 0.068197 .  
## age  -0.06711   0.93510  0.02085 -3.218 0.001289 ** 
## prio  0.09689   1.10174  0.02725  3.555 0.000378 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## fin     0.7068     1.4148    0.4868    1.0263
## age     0.9351     1.0694    0.8977    0.9741
## prio    1.1017     0.9077    1.0444    1.1622
## 
## Concordance= 0.63  (se = 0.027 )
## Likelihood ratio test= 29.05  on 3 df,   p=2e-06
## Wald test            = 27.94  on 3 df,   p=4e-06
## Score (logrank) test = 29.03  on 3 df,   p=2e-06</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="cox-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">exp</span>(<span class="fu">coef</span>(recid.ph2))<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span></span></code></pre></div>
<pre><code>##       fin       age      prio 
## -29.31625  -6.49033  10.17427</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="cox-regression.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Automatic Selection Techniques #</span></span>
<span id="cb7-2"><a href="cox-regression.html#cb7-2" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> wexp <span class="sc">+</span> mar <span class="sc">+</span>paro <span class="sc">+</span> prio, </span>
<span id="cb7-3"><a href="cox-regression.html#cb7-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> recid)</span>
<span id="cb7-4"><a href="cox-regression.html#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="cox-regression.html#cb7-5" aria-hidden="true" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest ) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> recid)</span>
<span id="cb7-6"><a href="cox-regression.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="cox-regression.html#cb7-7" aria-hidden="true" tabindex="-1"></a>step.model <span class="ot">&lt;-</span> <span class="fu">step</span>(empty.model, </span>
<span id="cb7-8"><a href="cox-regression.html#cb7-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="fu">formula</span>(empty.model), </span>
<span id="cb7-9"><a href="cox-regression.html#cb7-9" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">upper=</span><span class="fu">formula</span>(full.model)), </span>
<span id="cb7-10"><a href="cox-regression.html#cb7-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1350.76
## Surv(week, arrest) ~ 1
## 
##        Df    AIC
## + age   1 1337.5
## + prio  1 1340.8
## + wexp  1 1343.1
## + mar   1 1348.1
## + fin   1 1348.9
## &lt;none&gt;    1350.8
## + paro  1 1352.4
## 
## Step:  AIC=1337.49
## Surv(week, arrest) ~ age
## 
##        Df    AIC
## + prio  1 1329.1
## + wexp  1 1336.4
## + fin   1 1336.5
## &lt;none&gt;    1337.5
## + mar   1 1337.5
## + paro  1 1338.6
## - age   1 1350.8
## 
## Step:  AIC=1329.08
## Surv(week, arrest) ~ age + prio
## 
##        Df    AIC
## + fin   1 1327.7
## + mar   1 1329.0
## &lt;none&gt;    1329.1
## + wexp  1 1330.0
## + paro  1 1330.9
## - prio  1 1337.5
## - age   1 1340.8
## 
## Step:  AIC=1327.71
## Surv(week, arrest) ~ age + prio + fin
## 
##        Df    AIC
## + mar   1 1327.3
## &lt;none&gt;    1327.7
## + wexp  1 1328.6
## - fin   1 1329.1
## + paro  1 1329.4
## - prio  1 1336.5
## - age   1 1338.3
## 
## Step:  AIC=1327.35
## Surv(week, arrest) ~ age + prio + fin + mar
## 
##        Df    AIC
## &lt;none&gt;    1327.3
## - mar   1 1327.7
## + wexp  1 1328.8
## - fin   1 1329.0
## + paro  1 1329.2
## - age   1 1335.4
## - prio  1 1336.2</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="cox-regression.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step.model)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ age + prio + fin + mar, 
##     data = recid)
## 
##   n= 432, number of events= 114 
## 
##          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## age  -0.06042   0.94137  0.02085 -2.897  0.00376 ** 
## prio  0.09751   1.10243  0.02722  3.583  0.00034 ***
## fin  -0.36020   0.69753  0.19049 -1.891  0.05864 .  
## mar  -0.53312   0.58677  0.37276 -1.430  0.15266    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## age     0.9414     1.0623    0.9037    0.9806
## prio    1.1024     0.9071    1.0452    1.1628
## fin     0.6975     1.4336    0.4802    1.0132
## mar     0.5868     1.7042    0.2826    1.2183
## 
## Concordance= 0.633  (se = 0.027 )
## Likelihood ratio test= 31.41  on 4 df,   p=3e-06
## Wald test            = 29.98  on 4 df,   p=5e-06
## Score (logrank) test = 31.25  on 4 df,   p=3e-06</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="cox-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age  <span class="sc">+</span> wexp <span class="sc">+</span> mar <span class="sc">+</span>paro <span class="sc">+</span> prio, </span>
<span id="cb11-2"><a href="cox-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> recid)</span>
<span id="cb11-3"><a href="cox-regression.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="cox-regression.html#cb11-4" aria-hidden="true" tabindex="-1"></a>back.model <span class="ot">&lt;-</span> <span class="fu">step</span>(full.model, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1330.62
## Surv(week, arrest) ~ fin + age + wexp + mar + paro + prio
## 
##        Df    AIC
## - paro  1 1328.8
## - wexp  1 1329.2
## - mar   1 1330.3
## &lt;none&gt;    1330.6
## - fin   1 1332.3
## - age   1 1336.3
## - prio  1 1337.2
## 
## Step:  AIC=1328.78
## Surv(week, arrest) ~ fin + age + wexp + mar + prio
## 
##        Df    AIC
## - wexp  1 1327.3
## - mar   1 1328.6
## &lt;none&gt;    1328.8
## - fin   1 1330.4
## - age   1 1334.3
## - prio  1 1335.8
## 
## Step:  AIC=1327.35
## Surv(week, arrest) ~ fin + age + mar + prio
## 
##        Df    AIC
## &lt;none&gt;    1327.3
## - mar   1 1327.7
## - fin   1 1329.0
## - age   1 1335.4
## - prio  1 1336.2</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="cox-regression.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(back.model)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ fin + age + mar + prio, 
##     data = recid)
## 
##   n= 432, number of events= 114 
## 
##          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## fin  -0.36020   0.69753  0.19049 -1.891  0.05864 .  
## age  -0.06042   0.94137  0.02085 -2.897  0.00376 ** 
## mar  -0.53312   0.58677  0.37276 -1.430  0.15266    
## prio  0.09751   1.10243  0.02722  3.583  0.00034 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## fin     0.6975     1.4336    0.4802    1.0132
## age     0.9414     1.0623    0.9037    0.9806
## mar     0.5868     1.7042    0.2826    1.2183
## prio    1.1024     0.9071    1.0452    1.1628
## 
## Concordance= 0.633  (se = 0.027 )
## Likelihood ratio test= 31.41  on 4 df,   p=3e-06
## Wald test            = 29.98  on 4 df,   p=5e-06
## Score (logrank) test = 31.25  on 4 df,   p=3e-06</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="cox-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age  <span class="sc">+</span> wexp <span class="sc">+</span> mar <span class="sc">+</span>paro <span class="sc">+</span> prio, </span>
<span id="cb15-2"><a href="cox-regression.html#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">data =</span> recid)</span>
<span id="cb15-3"><a href="cox-regression.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="cox-regression.html#cb15-4" aria-hidden="true" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> recid)</span>
<span id="cb15-5"><a href="cox-regression.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="cox-regression.html#cb15-6" aria-hidden="true" tabindex="-1"></a>for.model <span class="ot">&lt;-</span> <span class="fu">step</span>(empty.model, </span>
<span id="cb15-7"><a href="cox-regression.html#cb15-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower=</span><span class="fu">formula</span>(empty.model), </span>
<span id="cb15-8"><a href="cox-regression.html#cb15-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">upper=</span><span class="fu">formula</span>(full.model)), </span>
<span id="cb15-9"><a href="cox-regression.html#cb15-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>)</span></code></pre></div>
<pre><code>## Start:  AIC=1350.76
## Surv(week, arrest) ~ 1
## 
##        Df    AIC
## + age   1 1337.5
## + prio  1 1340.8
## + wexp  1 1343.1
## + mar   1 1348.1
## + fin   1 1348.9
## &lt;none&gt;    1350.8
## + paro  1 1352.4
## 
## Step:  AIC=1337.49
## Surv(week, arrest) ~ age
## 
##        Df    AIC
## + prio  1 1329.1
## + wexp  1 1336.4
## + fin   1 1336.5
## &lt;none&gt;    1337.5
## + mar   1 1337.5
## + paro  1 1338.6
## 
## Step:  AIC=1329.08
## Surv(week, arrest) ~ age + prio
## 
##        Df    AIC
## + fin   1 1327.7
## + mar   1 1329.0
## &lt;none&gt;    1329.1
## + wexp  1 1330.0
## + paro  1 1330.9
## 
## Step:  AIC=1327.71
## Surv(week, arrest) ~ age + prio + fin
## 
##        Df    AIC
## + mar   1 1327.3
## &lt;none&gt;    1327.7
## + wexp  1 1328.6
## + paro  1 1329.4
## 
## Step:  AIC=1327.35
## Surv(week, arrest) ~ age + prio + fin + mar
## 
##        Df    AIC
## &lt;none&gt;    1327.3
## + wexp  1 1328.8
## + paro  1 1329.2</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="cox-regression.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(for.model)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ age + prio + fin + mar, 
##     data = recid)
## 
##   n= 432, number of events= 114 
## 
##          coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## age  -0.06042   0.94137  0.02085 -2.897  0.00376 ** 
## prio  0.09751   1.10243  0.02722  3.583  0.00034 ***
## fin  -0.36020   0.69753  0.19049 -1.891  0.05864 .  
## mar  -0.53312   0.58677  0.37276 -1.430  0.15266    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##      exp(coef) exp(-coef) lower .95 upper .95
## age     0.9414     1.0623    0.9037    0.9806
## prio    1.1024     0.9071    1.0452    1.1628
## fin     0.6975     1.4336    0.4802    1.0132
## mar     0.5868     1.7042    0.2826    1.2183
## 
## Concordance= 0.633  (se = 0.027 )
## Likelihood ratio test= 31.41  on 4 df,   p=3e-06
## Wald test            = 29.98  on 4 df,   p=5e-06
## Score (logrank) test = 31.25  on 4 df,   p=3e-06</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="cox-regression.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated Survival Curves #</span></span>
<span id="cb19-2"><a href="cox-regression.html#cb19-2" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">fin =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">age =</span> <span class="dv">30</span>, <span class="at">wexp =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb19-3"><a href="cox-regression.html#cb19-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mar =</span> <span class="dv">0</span>, <span class="at">paro =</span> <span class="dv">0</span>, <span class="at">prio =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb19-4"><a href="cox-regression.html#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="cox-regression.html#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsurvplot</span>(<span class="fu">survfit</span>(recid.ph, newdata), <span class="at">data =</span> newdata, <span class="at">break.y.by =</span> <span class="fl">0.1</span>,</span>
<span id="cb19-6"><a href="cox-regression.html#cb19-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;purple&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">ylab =</span> <span class="st">&quot;survival probability&quot;</span>,</span>
<span id="cb19-7"><a href="cox-regression.html#cb19-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="st">&quot;week&quot;</span>, <span class="at">legend.labs =</span> <span class="fu">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>), <span class="at">legend.title =</span> <span class="st">&quot;subject&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: `gather_()` was deprecated in tidyr 1.2.0.
## Please use `gather()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<p><img src="bookdownproj_files/figure-html/Cox%20Regression-1.png" width="672" /></p>
<div id="diagnostics" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Diagnostics<a href="cox-regression.html#diagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Assumptions made for the Cox PH model is linearity for the continuous variables and proportional hazards throughout time (i.e. at EACH time point, the proportion between the hazards remains the same!). We can assess both of these through use of residuals.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="cox-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Concordance </span></span>
<span id="cb21-2"><a href="cox-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a>recid.ph <span class="ot">=</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> prio, <span class="at">data =</span> recid)</span>
<span id="cb21-3"><a href="cox-regression.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">concordance</span>(recid.ph)</span></code></pre></div>
<pre><code>## Call:
## concordance.coxph(object = recid.ph)
## 
## n= 432 
## Concordance= 0.6302 se= 0.02729
## concordant discordant     tied.x     tied.y    tied.xy 
##      26736      15651        195        111          0</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="cox-regression.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Partial residuals...Linearity</span></span>
<span id="cb23-2"><a href="cox-regression.html#cb23-2" aria-hidden="true" tabindex="-1"></a>recid.ph <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> wexp <span class="sc">+</span> mar <span class="sc">+</span>paro <span class="sc">+</span> prio, <span class="at">data =</span> recid)</span>
<span id="cb23-3"><a href="cox-regression.html#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="cox-regression.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(recid.ph, <span class="st">&quot;age&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;age&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;partial residuals&quot;</span>,        <span class="at">gg =</span> <span class="cn">TRUE</span>, <span class="at">band =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="fu">geom_smooth</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb23-5"><a href="cox-regression.html#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() </span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/PH%20diagnostics-1.png" width="672" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="cox-regression.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visreg</span>(recid.ph, <span class="st">&quot;prio&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;#prior convictions&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;partial residuals&quot;</span>,    <span class="at">gg =</span> <span class="cn">TRUE</span>, <span class="at">band =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  <span class="fu">geom_smooth</span>(<span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39; and formula &#39;y ~ x&#39;</code></pre>
<p><img src="bookdownproj_files/figure-html/PH%20diagnostics-2.png" width="672" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="cox-regression.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Martingale residuals...Linearity</span></span>
<span id="cb27-2"><a href="cox-regression.html#cb27-2" aria-hidden="true" tabindex="-1"></a>recid.lin <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span>  age <span class="sc">+</span> prio, <span class="at">data =</span> recid)</span>
<span id="cb27-3"><a href="cox-regression.html#cb27-3" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxfunctional</span>(recid.lin,<span class="at">data=</span>recid)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/PH%20diagnostics-3.png" width="672" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="cox-regression.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Try transformations</span></span>
<span id="cb28-2"><a href="cox-regression.html#cb28-2" aria-hidden="true" tabindex="-1"></a>recid.lin <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span>  <span class="fu">sqrt</span>(age) , <span class="at">data =</span> recid)</span>
<span id="cb28-3"><a href="cox-regression.html#cb28-3" aria-hidden="true" tabindex="-1"></a>survminer<span class="sc">::</span><span class="fu">ggcoxfunctional</span>(recid.lin,<span class="at">data=</span>recid)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/PH%20diagnostics-4.png" width="672" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="cox-regression.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportional Hazard Test - Schoenfeld Residuals </span></span>
<span id="cb29-2"><a href="cox-regression.html#cb29-2" aria-hidden="true" tabindex="-1"></a>recid.ph.zph <span class="ot">&lt;-</span> <span class="fu">cox.zph</span>(recid.ph, <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb29-3"><a href="cox-regression.html#cb29-3" aria-hidden="true" tabindex="-1"></a>recid.ph.zph</span></code></pre></div>
<pre><code>##           chisq df      p
## fin     0.00878  1 0.9254
## age     6.55134  1 0.0105
## wexp    3.94780  1 0.0469
## mar     1.04080  1 0.3076
## paro    0.02280  1 0.8800
## prio    0.42929  1 0.5123
## GLOBAL 16.85230  6 0.0098</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="cox-regression.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcoxzph</span>(recid.ph.zph)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/PH%20diagnostics-5.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="cox-regression.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can try transformations..</span></span>
<span id="cb32-2"><a href="cox-regression.html#cb32-2" aria-hidden="true" tabindex="-1"></a>recid.ph.zph2 <span class="ot">=</span> <span class="fu">cox.zph</span>(recid.ph, <span class="at">transform =</span> <span class="st">&quot;km&quot;</span>)</span>
<span id="cb32-3"><a href="cox-regression.html#cb32-3" aria-hidden="true" tabindex="-1"></a>recid.ph.zph2</span></code></pre></div>
<pre><code>##          chisq df     p
## fin     0.0621  1 0.803
## age     5.9161  1 0.015
## wexp    4.2983  1 0.038
## mar     1.0207  1 0.312
## paro    0.0140  1 0.906
## prio    0.5254  1 0.469
## GLOBAL 16.4474  6 0.012</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="cox-regression.html#cb34-1" aria-hidden="true" tabindex="-1"></a>recid.ph.zph3 <span class="ot">=</span> <span class="fu">cox.zph</span>(recid.ph, <span class="at">transform =</span> <span class="st">&quot;identity&quot;</span>)</span>
<span id="cb34-2"><a href="cox-regression.html#cb34-2" aria-hidden="true" tabindex="-1"></a>recid.ph.zph3</span></code></pre></div>
<pre><code>##           chisq df      p
## fin     0.00878  1 0.9254
## age     6.55134  1 0.0105
## wexp    3.94780  1 0.0469
## mar     1.04080  1 0.3076
## paro    0.02280  1 0.8800
## prio    0.42929  1 0.5123
## GLOBAL 16.85230  6 0.0098</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="cox-regression.html#cb36-1" aria-hidden="true" tabindex="-1"></a>recid.ph.zph4 <span class="ot">=</span> <span class="fu">cox.zph</span>(recid.ph, <span class="at">transform =</span> <span class="st">&quot;log&quot;</span>)</span>
<span id="cb36-2"><a href="cox-regression.html#cb36-2" aria-hidden="true" tabindex="-1"></a>recid.ph.zph4</span></code></pre></div>
<pre><code>##          chisq df      p
## fin     0.1391  1 0.7092
## age     8.1533  1 0.0043
## wexp    2.1341  1 0.1441
## mar     1.1319  1 0.2874
## paro    0.2092  1 0.6474
## prio    0.0126  1 0.9105
## GLOBAL 16.6501  6 0.0107</code></pre>
<p>If we believe that the PH assumption is not true for one (or more) variables, then we can explore what type of relationship is the best (with respect to time). Options are “identity”, “log” and “KM” (although identity and log are the most commonly used). The first part of the code below illustrates how to fit the time-dependent coefficients.</p>
<p>The second part of the R code below illustrates how to fit time-varying variables (variables that change their values throughout time).</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="cox-regression.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time-Dependent Coefficients #</span></span>
<span id="cb38-2"><a href="cox-regression.html#cb38-2" aria-hidden="true" tabindex="-1"></a>recid.ph.tdc <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span> fin <span class="sc">+</span>  wexp <span class="sc">+</span> mar <span class="sc">+</span> paro <span class="sc">+</span> prio<span class="sc">+</span> age <span class="sc">+</span> <span class="fu">tt</span>(age), <span class="at">data =</span> recid,</span>
<span id="cb38-3"><a href="cox-regression.html#cb38-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">tt =</span> <span class="cf">function</span>(x, time, ...){x<span class="sc">*</span><span class="fu">log</span>(time)})</span>
<span id="cb38-4"><a href="cox-regression.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid.ph.tdc)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ fin + wexp + mar + paro + 
##     prio + age + tt(age), data = recid, tt = function(x, time, 
##     ...) {
##     x * log(time)
## })
## 
##   n= 432, number of events= 114 
## 
##             coef exp(coef) se(coef)      z Pr(&gt;|z|)   
## fin     -0.36527   0.69401  0.19087 -1.914  0.05566 . 
## wexp    -0.13317   0.87531  0.21247 -0.627  0.53080   
## mar     -0.45279   0.63585  0.38041 -1.190  0.23394   
## paro    -0.08490   0.91860  0.19534 -0.435  0.66382   
## prio     0.09177   1.09611  0.02880  3.186  0.00144 **
## age      0.12174   1.12946  0.06535  1.863  0.06249 . 
## tt(age) -0.05931   0.94242  0.02182 -2.718  0.00658 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##         exp(coef) exp(-coef) lower .95 upper .95
## fin        0.6940     1.4409    0.4774    1.0089
## wexp       0.8753     1.1424    0.5772    1.3275
## mar        0.6358     1.5727    0.3017    1.3402
## paro       0.9186     1.0886    0.6264    1.3471
## prio       1.0961     0.9123    1.0359    1.1598
## age        1.1295     0.8854    0.9937    1.2838
## tt(age)    0.9424     1.0611    0.9030    0.9836
## 
## Concordance= 0.648  (se = 0.027 )
## Likelihood ratio test= 38.72  on 7 df,   p=2e-06
## Wald test            = 35.09  on 7 df,   p=1e-05
## Score (logrank) test = 36.97  on 7 df,   p=5e-06</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="cox-regression.html#cb40-1" aria-hidden="true" tabindex="-1"></a>recid.ph.tdc <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(week, arrest) <span class="sc">~</span>  fin <span class="sc">+</span> prio <span class="sc">+</span>  age <span class="sc">+</span> <span class="fu">tt</span>(age), <span class="at">data =</span> recid,</span>
<span id="cb40-2"><a href="cox-regression.html#cb40-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">tt =</span> <span class="cf">function</span>(x, time, ...){x<span class="sc">*</span><span class="fu">log</span>(time)})</span>
<span id="cb40-3"><a href="cox-regression.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid.ph.tdc)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(week, arrest) ~ fin + prio + age + tt(age), 
##     data = recid, tt = function(x, time, ...) {
##         x * log(time)
##     })
## 
##   n= 432, number of events= 114 
## 
##             coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## fin     -0.34878   0.70555  0.19025 -1.833 0.066762 .  
## prio     0.09837   1.10337  0.02731  3.603 0.000315 ***
## age      0.11991   1.12739  0.06623  1.810 0.070220 .  
## tt(age) -0.06195   0.93993  0.02207 -2.807 0.005005 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##         exp(coef) exp(-coef) lower .95 upper .95
## fin        0.7055     1.4173    0.4859    1.0244
## prio       1.1034     0.9063    1.0459    1.1640
## age        1.1274     0.8870    0.9901    1.2837
## tt(age)    0.9399     1.0639    0.9001    0.9815
## 
## Concordance= 0.635  (se = 0.028 )
## Likelihood ratio test= 36  on 4 df,   p=3e-07
## Wald test            = 32.41  on 4 df,   p=2e-06
## Score (logrank) test = 33.75  on 4 df,   p=8e-07</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="cox-regression.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time Varying Variables #</span></span>
<span id="cb42-2"><a href="cox-regression.html#cb42-2" aria-hidden="true" tabindex="-1"></a>recid_long.ph <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, arrested) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span> prio <span class="sc">+</span> employed, <span class="at">data =</span> recid_long)</span>
<span id="cb42-3"><a href="cox-regression.html#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid_long.ph)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(start, stop, arrested) ~ fin + age + prio + 
##     employed, data = recid_long)
## 
##   n= 19809, number of events= 114 
## 
##              coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## fin      -0.33051   0.71856  0.19012 -1.738  0.08214 .  
## age      -0.04977   0.95145  0.02053 -2.424  0.01537 *  
## prio      0.08364   1.08724  0.02775  3.014  0.00258 ** 
## employed -1.34815   0.25972  0.24928 -5.408 6.37e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## fin         0.7186     1.3917    0.4950    1.0430
## age         0.9515     1.0510    0.9139    0.9905
## prio        1.0872     0.9198    1.0297    1.1480
## employed    0.2597     3.8503    0.1593    0.4233
## 
## Concordance= 0.703  (se = 0.023 )
## Likelihood ratio test= 66.19  on 4 df,   p=1e-13
## Wald test            = 53.93  on 4 df,   p=5e-11
## Score (logrank) test = 62.05  on 4 df,   p=1e-12</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="cox-regression.html#cb44-1" aria-hidden="true" tabindex="-1"></a>recid_lag.ph <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">Surv</span>(start, stop, arrested) <span class="sc">~</span> fin <span class="sc">+</span> age <span class="sc">+</span>  prio <span class="sc">+</span> employed, <span class="at">data =</span> recid_lag)</span>
<span id="cb44-2"><a href="cox-regression.html#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recid_lag.ph)</span></code></pre></div>
<pre><code>## Call:
## coxph(formula = Surv(start, stop, arrested) ~ fin + age + prio + 
##     employed, data = recid_lag)
## 
##   n= 19377, number of events= 113 
## 
##              coef exp(coef) se(coef)      z Pr(&gt;|z|)    
## fin      -0.32464   0.72278  0.19077 -1.702 0.088803 .  
## age      -0.05462   0.94685  0.02073 -2.635 0.008409 ** 
## prio      0.09158   1.09590  0.02753  3.326 0.000880 ***
## employed -0.81123   0.44431  0.21648 -3.747 0.000179 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## fin         0.7228     1.3835    0.4973    1.0505
## age         0.9468     1.0561    0.9092    0.9861
## prio        1.0959     0.9125    1.0383    1.1567
## employed    0.4443     2.2507    0.2907    0.6791
## 
## Concordance= 0.665  (se = 0.027 )
## Likelihood ratio test= 44.5  on 4 df,   p=5e-09
## Wald test            = 40.91  on 4 df,   p=3e-08
## Score (logrank) test = 43.68  on 4 df,   p=7e-09</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="aft.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="competing-risks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sjsimmo2/Survival/edit/master/04-CoxRegression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/sjsimmo2/Survival/blob/master/04-CoxRegression.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
